<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>OptimalBinningWoE: Practical Guide for Credit Risk Modeling • OptimalBinningWoE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="OptimalBinningWoE: Practical Guide for Credit Risk Modeling">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OptimalBinningWoE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">OptimalBinningWoE: Practical Guide for Credit Risk Modeling</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/evandeilton/OptimalBinningWoE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>OptimalBinningWoE: Practical Guide for Credit Risk Modeling</h1>
                        <h4 data-toc-skip class="author">José
Evandeilton Lopes</h4>
            
            <h4 data-toc-skip class="date">2026-01-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/evandeilton/OptimalBinningWoE/blob/main/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>OptimalBinningWoE</strong> implements 36 high-performance
binning algorithms for Weight of Evidence (WoE) transformation in credit
scoring and risk modeling. This vignette demonstrates practical
applications using real-world credit data.</p>
<div class="section level3">
<h3 id="package-overview">Package Overview<a class="anchor" aria-label="anchor" href="#package-overview"></a>
</h3>
<p>The package provides:</p>
<ul>
<li>
<strong>36 algorithms</strong>: 20 numerical + 16 categorical
methods</li>
<li>
<strong>C++ performance</strong>: Fast processing of large
datasets</li>
<li>
<strong>tidymodels integration</strong>: Production-ready ML
pipelines</li>
<li>
<strong>Regulatory compliance</strong>: Monotonic binning for
Basel/IFRS 9</li>
<li>
<strong>Comprehensive metrics</strong>: IV, KS, Gini, lift
curves</li>
</ul>
</div>
<div class="section level3">
<h3 id="theoretical-foundation">Theoretical Foundation<a class="anchor" aria-label="anchor" href="#theoretical-foundation"></a>
</h3>
<div class="section level4">
<h4 id="weight-of-evidence-woe">Weight of Evidence (WoE)<a class="anchor" aria-label="anchor" href="#weight-of-evidence-woe"></a>
</h4>
<p>For bin
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
WoE quantifies the logarithmic odds ratio:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext mathvariant="normal">WoE</mtext><mi>i</mi></msub><mo>=</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mtext mathvariant="normal">Distribution of Events</mtext><mi>i</mi></msub><msub><mtext mathvariant="normal">Distribution of Non-Events</mtext><mi>i</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>n</mi><mrow><mi>i</mi><mo>,</mo><mn>1</mn></mrow></msub><mi>/</mi><msub><mi>N</mi><mn>1</mn></msub></mrow><mrow><msub><mi>n</mi><mrow><mi>i</mi><mo>,</mo><mn>0</mn></mrow></msub><mi>/</mi><msub><mi>N</mi><mn>0</mn></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{WoE}_i = \ln\left(\frac{\text{Distribution of Events}_i}{\text{Distribution of Non-Events}_i}\right) = \ln\left(\frac{n_{i,1}/N_1}{n_{i,0}/N_0}\right)</annotation></semantics></math></p>
<p><strong>Interpretation</strong>: - WoE &gt; 0: Higher risk than
population average - WoE &lt; 0: Lower risk than population
average<br>
- WoE ≈ 0: Similar to population average</p>
</div>
<div class="section level4">
<h4 id="information-value-iv">Information Value (IV)<a class="anchor" aria-label="anchor" href="#information-value-iv"></a>
</h4>
<p>IV measures total predictive power:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">IV</mtext><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>n</mi><mrow><mi>i</mi><mo>,</mo><mn>1</mn></mrow></msub><msub><mi>N</mi><mn>1</mn></msub></mfrac><mo>−</mo><mfrac><msub><mi>n</mi><mrow><mi>i</mi><mo>,</mo><mn>0</mn></mrow></msub><msub><mi>N</mi><mn>0</mn></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><msub><mtext mathvariant="normal">WoE</mtext><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\text{IV} = \sum_{i=1}^{k} \left(\frac{n_{i,1}}{N_1} - \frac{n_{i,0}}{N_0}\right) \times \text{WoE}_i</annotation></semantics></math></p>
<p><strong>Benchmarks</strong> (Siddiqi, 2006):</p>
<table class="table">
<thead><tr class="header">
<th>IV Range</th>
<th>Predictive Power</th>
<th>Recommendation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>&lt; 0.02</td>
<td>Unpredictive</td>
<td>Exclude</td>
</tr>
<tr class="even">
<td>0.02 - 0.10</td>
<td>Weak</td>
<td>Marginal</td>
</tr>
<tr class="odd">
<td>0.10 - 0.30</td>
<td>Medium</td>
<td>Include</td>
</tr>
<tr class="even">
<td>0.30 - 0.50</td>
<td>Strong</td>
<td>Prioritize</td>
</tr>
<tr class="odd">
<td>&gt; 0.50</td>
<td>Suspicious</td>
<td>Check leakage</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># From GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"evandeilton/OptimalBinningWoE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install dependencies for this vignette</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scorecard"</span>, <span class="st">"tidymodels"</span>, <span class="st">"pROC"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dataset-german-credit-data">Dataset: German Credit Data<a class="anchor" aria-label="anchor" href="#dataset-german-credit-data"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/evandeilton/OptimalBinningWoE" class="external-link">OptimalBinningWoE</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ShichenXie/scorecard" class="external-link">scorecard</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load German credit dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"germancredit"</span>, package <span class="op">=</span> <span class="st">"scorecard"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">germancredit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000   21</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">germancredit</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1000 obs. of  8 variables:</span></span>
<span><span class="co">#&gt;  $ status.of.existing.checking.account                : Factor w/ 4 levels "... &lt; 0 DM","0 &lt;= ... &lt; 200 DM",..: 1 2 4 1 1 4 4 2 4 2 ...</span></span>
<span><span class="co">#&gt;  $ duration.in.month                                  : num  6 48 12 42 24 36 24 36 12 30 ...</span></span>
<span><span class="co">#&gt;  $ credit.history                                     : Factor w/ 5 levels "no credits taken/ all credits paid back duly",..: 5 3 5 3 4 3 3 3 3 5 ...</span></span>
<span><span class="co">#&gt;  $ purpose                                            : chr  "radio/television" "radio/television" "education" "furniture/equipment" ...</span></span>
<span><span class="co">#&gt;  $ credit.amount                                      : num  1169 5951 2096 7882 4870 ...</span></span>
<span><span class="co">#&gt;  $ savings.account.and.bonds                          : Factor w/ 5 levels "... &lt; 100 DM",..: 5 1 1 1 1 5 3 1 4 1 ...</span></span>
<span><span class="co">#&gt;  $ present.employment.since                           : Factor w/ 5 levels "unemployed","... &lt; 1 year",..: 5 3 4 4 3 3 5 3 4 1 ...</span></span>
<span><span class="co">#&gt;  $ installment.rate.in.percentage.of.disposable.income: num  4 2 2 2 3 2 3 2 2 4 ...</span></span>
<span></span>
<span><span class="co"># Target variable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">germancredit</span><span class="op">$</span><span class="va">creditability</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  bad good </span></span>
<span><span class="co">#&gt;  300  700</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nDefault rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">germancredit</span><span class="op">$</span><span class="va">creditability</span> <span class="op">==</span> <span class="st">"bad"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Default rate: 30 %</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create binary target (must be a factor for tidymodels classification)</span></span>
<span><span class="va">german</span> <span class="op">&lt;-</span> <span class="va">germancredit</span></span>
<span><span class="va">german</span><span class="op">$</span><span class="va">default</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">german</span><span class="op">$</span><span class="va">creditability</span> <span class="op">==</span> <span class="st">"bad"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"good"</span>, <span class="st">"bad"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">german</span><span class="op">$</span><span class="va">creditability</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># Select key features for demonstration</span></span>
<span><span class="va">features_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"duration.in.month"</span>, <span class="st">"credit.amount"</span>, <span class="st">"age.in.years"</span><span class="op">)</span></span>
<span><span class="va">features_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"status.of.existing.checking.account"</span>, <span class="st">"credit.history"</span>,</span>
<span>  <span class="st">"purpose"</span>, <span class="st">"savings.account.and.bonds"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">german_model</span> <span class="op">&lt;-</span> <span class="va">german</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"default"</span>, <span class="va">features_num</span>, <span class="va">features_cat</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Summary statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Numerical features:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Numerical features:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">german_model</span><span class="op">[</span>, <span class="va">features_num</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  duration.in.month credit.amount    age.in.years  </span></span>
<span><span class="co">#&gt;  Min.   : 4.0      Min.   :  250   Min.   :19.00  </span></span>
<span><span class="co">#&gt;  1st Qu.:12.0      1st Qu.: 1366   1st Qu.:27.00  </span></span>
<span><span class="co">#&gt;  Median :18.0      Median : 2320   Median :33.00  </span></span>
<span><span class="co">#&gt;  Mean   :20.9      Mean   : 3271   Mean   :35.55  </span></span>
<span><span class="co">#&gt;  3rd Qu.:24.0      3rd Qu.: 3972   3rd Qu.:42.00  </span></span>
<span><span class="co">#&gt;  Max.   :72.0      Max.   :18424   Max.   :75.00</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nCategorical features:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Categorical features:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">german_model</span><span class="op">[</span>, <span class="va">features_cat</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; status.of.existing.checking.account                      credit.history </span></span>
<span><span class="co">#&gt;                                   4                                   5 </span></span>
<span><span class="co">#&gt;                             purpose           savings.account.and.bonds </span></span>
<span><span class="co">#&gt;                                  10                                   5</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quick-start-single-feature-binning">Quick Start: Single Feature Binning<a class="anchor" aria-label="anchor" href="#quick-start-single-feature-binning"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bin credit amount with JEDI algorithm</span></span>
<span><span class="va">result_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe.html">obwoe</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">german_model</span>,</span>
<span>  target <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  feature <span class="op">=</span> <span class="st">"credit.amount"</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"jedi"</span>,</span>
<span>  min_bins <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_bins <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_single</span><span class="op">)</span></span>
<span><span class="co">#&gt; Optimal Binning Weight of Evidence</span></span>
<span><span class="co">#&gt; ===================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target: default ( binary )</span></span>
<span><span class="co">#&gt; Features processed: 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results:  1  successful</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Top features by IV:</span></span>
<span><span class="co">#&gt;   credit.amount: IV = 0.0023 (3 bins, jedi)</span></span>
<span></span>
<span><span class="co"># Detailed binning table</span></span>
<span><span class="va">result_single</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">credit.amount</span></span>
<span><span class="co">#&gt; $id</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $bin</span></span>
<span><span class="co">#&gt; [1] "(-Inf;1283.000000]"        "(1283.000000;1393.000000]"</span></span>
<span><span class="co">#&gt; [3] "(1393.000000;+Inf]"       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $woe</span></span>
<span><span class="co">#&gt; [1]  0.07525674 -0.13353139 -0.01237398</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $iv</span></span>
<span><span class="co">#&gt; [1] 0.0012184424 0.0009537957 0.0001119550</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $count</span></span>
<span><span class="co">#&gt; [1] 212  55 733</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $count_pos</span></span>
<span><span class="co">#&gt; [1]  67  15 218</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $count_neg</span></span>
<span><span class="co">#&gt; [1] 145  40 515</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cutpoints</span></span>
<span><span class="co">#&gt; [1] 1283 1393</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $converged</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $iterations</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $feature</span></span>
<span><span class="co">#&gt; [1] "credit.amount"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "numerical"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $algorithm</span></span>
<span><span class="co">#&gt; [1] "jedi"</span></span></code></pre></div>
<div class="section level3">
<h3 id="visualize-binning-results">Visualize Binning Results<a class="anchor" aria-label="anchor" href="#visualize-binning-results"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># WoE pattern visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_single</span>, type <span class="op">=</span> <span class="st">"woe"</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/quickstart_plot-1.png" class="r-plt" alt="" width="768"></p>
</div>
<div class="section level3">
<h3 id="key-insights-from-single-feature">Key Insights from Single Feature<a class="anchor" aria-label="anchor" href="#key-insights-from-single-feature"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract metrics</span></span>
<span><span class="va">bins</span> <span class="op">&lt;-</span> <span class="va">result_single</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">credit.amount</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Binning Summary:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Binning Summary:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Number of bins:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bins</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Number of bins:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Total IV:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">bins</span><span class="op">$</span><span class="va">iv</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Total IV: 0.0023</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Monotonic:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">bins</span><span class="op">$</span><span class="va">woe</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">bins</span><span class="op">$</span><span class="va">woe</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Monotonic: FALSE</span></span>
<span></span>
<span><span class="co"># Event rates by bin</span></span>
<span><span class="va">bins_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Bin <span class="op">=</span> <span class="va">bins</span><span class="op">$</span><span class="va">bin</span>,</span>
<span>  Count <span class="op">=</span> <span class="va">bins</span><span class="op">$</span><span class="va">count</span>,</span>
<span>  Event_Rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bins</span><span class="op">$</span><span class="va">count_pos</span> <span class="op">/</span> <span class="va">bins</span><span class="op">$</span><span class="va">count</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  WoE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bins</span><span class="op">$</span><span class="va">woe</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  IV_Contribution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bins</span><span class="op">$</span><span class="va">iv</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bins_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         Bin Count Event_Rate     WoE IV_Contribution</span></span>
<span><span class="co">#&gt; 1        (-Inf;1283.000000]   212      31.60  0.0753          0.0012</span></span>
<span><span class="co">#&gt; 2 (1283.000000;1393.000000]    55      27.27 -0.1335          0.0010</span></span>
<span><span class="co">#&gt; 3        (1393.000000;+Inf]   733      29.74 -0.0124          0.0001</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="multiple-features-automated-binning">Multiple Features: Automated Binning<a class="anchor" aria-label="anchor" href="#multiple-features-automated-binning"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bin all features simultaneously</span></span>
<span><span class="va">result_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe.html">obwoe</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">german_model</span>,</span>
<span>  target <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"cm"</span>,</span>
<span>  min_bins <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_bins <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary of all features</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_multi</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary: Optimal Binning Weight of Evidence</span></span>
<span><span class="co">#&gt; ============================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target: default ( binary )</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Aggregate Statistics:</span></span>
<span><span class="co">#&gt;   Features: 7 total, 7 successful, 0 errors</span></span>
<span><span class="co">#&gt;   Total IV: 1.5179</span></span>
<span><span class="co">#&gt;   Mean IV: 0.2168 (SD: 0.2231)</span></span>
<span><span class="co">#&gt;   Median IV: 0.1897</span></span>
<span><span class="co">#&gt;   IV Range: [0.0018, 0.6624]</span></span>
<span><span class="co">#&gt;   Mean Bins: 3.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; IV Classification (Siddiqi, 2006):</span></span>
<span><span class="co">#&gt;   Unpredictive: 2 features</span></span>
<span><span class="co">#&gt;   Medium      : 4 features</span></span>
<span><span class="co">#&gt;   Suspicious  : 1 features</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Feature Details:</span></span>
<span><span class="co">#&gt;                              feature        type n_bins    total_iv</span></span>
<span><span class="co">#&gt;  status.of.existing.checking.account categorical      4 0.662430485</span></span>
<span><span class="co">#&gt;                       credit.history categorical      4 0.289999923</span></span>
<span><span class="co">#&gt;                    duration.in.month   numerical      4 0.206606852</span></span>
<span><span class="co">#&gt;            savings.account.and.bonds categorical      3 0.189741384</span></span>
<span><span class="co">#&gt;                              purpose categorical      4 0.161473063</span></span>
<span><span class="co">#&gt;                        credit.amount   numerical      3 0.005917450</span></span>
<span><span class="co">#&gt;                         age.in.years   numerical      3 0.001775917</span></span>
<span><span class="co">#&gt;      iv_class</span></span>
<span><span class="co">#&gt;    Suspicious</span></span>
<span><span class="co">#&gt;        Medium</span></span>
<span><span class="co">#&gt;        Medium</span></span>
<span><span class="co">#&gt;        Medium</span></span>
<span><span class="co">#&gt;        Medium</span></span>
<span><span class="co">#&gt;  Unpredictive</span></span>
<span><span class="co">#&gt;  Unpredictive</span></span></code></pre></div>
<div class="section level3">
<h3 id="feature-selection-by-iv">Feature Selection by IV<a class="anchor" aria-label="anchor" href="#feature-selection-by-iv"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract IV summary</span></span>
<span><span class="va">iv_summary</span> <span class="op">&lt;-</span> <span class="va">result_multi</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span><span class="op">!</span><span class="va">result_multi</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">error</span>, <span class="op">]</span></span>
<span><span class="va">iv_summary</span> <span class="op">&lt;-</span> <span class="va">iv_summary</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">iv_summary</span><span class="op">$</span><span class="va">total_iv</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Top predictive features</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Top 5 Features by Information Value:\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Top 5 Features by Information Value:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iv_summary</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"feature"</span>, <span class="st">"total_iv"</span>, <span class="st">"n_bins"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                               feature  total_iv n_bins</span></span>
<span><span class="co">#&gt; 4 status.of.existing.checking.account 0.6624305      4</span></span>
<span><span class="co">#&gt; 5                      credit.history 0.2899999      4</span></span>
<span><span class="co">#&gt; 1                   duration.in.month 0.2066069      4</span></span>
<span><span class="co">#&gt; 7           savings.account.and.bonds 0.1897414      3</span></span>
<span><span class="co">#&gt; 6                             purpose 0.1614731      4</span></span>
<span></span>
<span><span class="co"># Select features with IV &gt;= 0.02</span></span>
<span><span class="va">strong_features</span> <span class="op">&lt;-</span> <span class="va">iv_summary</span><span class="op">$</span><span class="va">feature</span><span class="op">[</span><span class="va">iv_summary</span><span class="op">$</span><span class="va">total_iv</span> <span class="op">&gt;=</span> <span class="fl">0.02</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nFeatures with IV &gt;= 0.02:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">strong_features</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Features with IV &gt;= 0.02: 5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gains-table-analysis">Gains Table Analysis<a class="anchor" aria-label="anchor" href="#gains-table-analysis"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute gains for best numerical feature</span></span>
<span><span class="va">best_num_feature</span> <span class="op">&lt;-</span> <span class="va">iv_summary</span><span class="op">$</span><span class="va">feature</span><span class="op">[</span></span>
<span>  <span class="va">iv_summary</span><span class="op">$</span><span class="va">feature</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">features_num</span></span>
<span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">gains</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe_gains.html">obwoe_gains</a></span><span class="op">(</span><span class="va">result_multi</span>, feature <span class="op">=</span> <span class="va">best_num_feature</span>, sort_by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gains</span><span class="op">)</span></span>
<span><span class="co">#&gt; Gains Table: duration.in.month </span></span>
<span><span class="co">#&gt; ================================================== </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Observations: 487  |  Bins: 4</span></span>
<span><span class="co">#&gt; Total IV: 0.4220</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Performance Metrics:</span></span>
<span><span class="co">#&gt;   KS Statistic: 27.55%</span></span>
<span><span class="co">#&gt;   Gini Coefficient: 34.25%</span></span>
<span><span class="co">#&gt;   AUC: 0.3287</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    bin count pos_rate     woe     iv cum_pos_pct    ks lift</span></span>
<span><span class="co">#&gt;        (-Inf;6.000000]    50   10.00% -1.2676 0.1270        3.3% 10.0% 0.32</span></span>
<span><span class="co">#&gt;   (7.000000;15.000000]   150   18.67% -0.6128 0.1075       22.0% 27.6% 0.32</span></span>
<span><span class="co">#&gt;  (16.000000;36.000000]   200   36.00%  0.2731 0.0274       70.0% 17.5% 0.32</span></span>
<span><span class="co">#&gt;       (39.000000;+Inf]    87   51.72%  0.9136 0.1602      100.0%  0.0% 0.32</span></span>
<span></span>
<span><span class="co"># Plot gains curves</span></span>
<span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gains</span>, type <span class="op">=</span> <span class="st">"cumulative"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gains</span>, type <span class="op">=</span> <span class="st">"ks"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gains</span>, type <span class="op">=</span> <span class="st">"lift"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gains</span>, type <span class="op">=</span> <span class="st">"woe_iv"</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/gains_analysis-1.png" class="r-plt" alt="" width="768"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="algorithm-comparison">Algorithm Comparison<a class="anchor" aria-label="anchor" href="#algorithm-comparison"></a>
</h2>
<p>Different algorithms excel in different scenarios. Let’s compare
performance.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test multiple algorithms on credit.amount</span></span>
<span><span class="va">algorithms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jedi"</span>, <span class="st">"mdlp"</span>, <span class="st">"mob"</span>, <span class="st">"ewb"</span>, <span class="st">"cm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">compare_algos</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">target</span>, <span class="va">feature</span>, <span class="va">algos</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">algos</span>, <span class="kw">function</span><span class="op">(</span><span class="va">algo</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>      <span class="op">{</span></span>
<span>        <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe.html">obwoe</a></span><span class="op">(</span></span>
<span>          data <span class="op">=</span> <span class="va">data</span>,</span>
<span>          target <span class="op">=</span> <span class="va">target</span>,</span>
<span>          feature <span class="op">=</span> <span class="va">feature</span>,</span>
<span>          algorithm <span class="op">=</span> <span class="va">algo</span>,</span>
<span>          min_bins <span class="op">=</span> <span class="fl">3</span>,</span>
<span>          max_bins <span class="op">=</span> <span class="fl">6</span></span>
<span>        <span class="op">)</span></span>
<span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>          Algorithm <span class="op">=</span> <span class="va">algo</span>,</span>
<span>          N_Bins <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">n_bins</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>          IV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">total_iv</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>          Converged <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">converged</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>          stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span>,</span>
<span>      error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># Return NA but log error for debugging during vignette rendering</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Algorithm '%s' failed: %s"</span>, <span class="va">algo</span>, <span class="va">e</span><span class="op">$</span><span class="va">message</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>          Algorithm <span class="op">=</span> <span class="va">algo</span>,</span>
<span>          N_Bins <span class="op">=</span> <span class="cn">NA_integer_</span>,</span>
<span>          IV <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>          Converged <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">results</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Compare on credit.amount</span></span>
<span><span class="va">comp_result</span> <span class="op">&lt;-</span> <span class="fu">compare_algos</span><span class="op">(</span></span>
<span>  <span class="va">german_model</span>,</span>
<span>  <span class="st">"default"</span>,</span>
<span>  <span class="st">"credit.amount"</span>,</span>
<span>  <span class="va">algorithms</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Algorithm Comparison on 'credit.amount':\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Algorithm Comparison on 'credit.amount':</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comp_result</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">comp_result</span><span class="op">$</span><span class="va">IV</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Algorithm N_Bins     IV Converged</span></span>
<span><span class="co">#&gt; 3       mob      5 0.0917      TRUE</span></span>
<span><span class="co">#&gt; 4       ewb      3 0.0735      TRUE</span></span>
<span><span class="co">#&gt; 5        cm      3 0.0617      TRUE</span></span>
<span><span class="co">#&gt; 2      mdlp      3 0.0107      TRUE</span></span>
<span><span class="co">#&gt; 1      jedi      3 0.0023      TRUE</span></span></code></pre></div>
<div class="section level3">
<h3 id="algorithm-selection-guide">Algorithm Selection Guide<a class="anchor" aria-label="anchor" href="#algorithm-selection-guide"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View algorithm capabilities</span></span>
<span><span class="va">algo_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe_algorithms.html">obwoe_algorithms</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Algorithm Categories:\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Algorithm Categories:</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Fast for Large Data (O(n) complexity):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fast for Large Data (O(n) complexity):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">algo_info</span><span class="op">[</span></span>
<span>  <span class="va">algo_info</span><span class="op">$</span><span class="va">algorithm</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ewb"</span>, <span class="st">"sketch"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"algorithm"</span>, <span class="st">"numerical"</span>, <span class="st">"categorical"</span><span class="op">)</span></span>
<span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;    algorithm numerical categorical</span></span>
<span><span class="co">#&gt; 8     sketch      TRUE        TRUE</span></span>
<span><span class="co">#&gt; 18       ewb      TRUE       FALSE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nRegulatory Compliant (Monotonic):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regulatory Compliant (Monotonic):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">algo_info</span><span class="op">[</span></span>
<span>  <span class="va">algo_info</span><span class="op">$</span><span class="va">algorithm</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mob"</span>, <span class="st">"mblp"</span>, <span class="st">"ir"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"algorithm"</span>, <span class="st">"numerical"</span>, <span class="st">"categorical"</span><span class="op">)</span></span>
<span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;    algorithm numerical categorical</span></span>
<span><span class="co">#&gt; 7        mob      TRUE        TRUE</span></span>
<span><span class="co">#&gt; 20        ir      TRUE       FALSE</span></span>
<span><span class="co">#&gt; 24      mblp      TRUE       FALSE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nGeneral Purpose (algorithm):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; General Purpose (algorithm):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">algo_info</span><span class="op">[</span></span>
<span>  <span class="va">algo_info</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jedi"</span>, <span class="st">"cm"</span>, <span class="st">"mdlp"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"algorithm"</span>, <span class="st">"numerical"</span>, <span class="st">"categorical"</span><span class="op">)</span></span>
<span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] algorithm   numerical   categorical</span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="algorithm-selection-by-use-case">Algorithm Selection by Use Case<a class="anchor" aria-label="anchor" href="#algorithm-selection-by-use-case"></a>
</h3>
<table class="table">
<colgroup>
<col width="23%">
<col width="51%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Use Case</th>
<th>Recommended Algorithm</th>
<th>Rationale</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>General credit scoring</strong></td>
<td>
<code>jedi</code>, <code>mob</code>
</td>
<td>Best balance of speed and predictive power.</td>
</tr>
<tr class="even">
<td><strong>Monotonicity mandatory</strong></td>
<td>
<code>mob</code>, <code>mblp</code>, <code>ir</code>
</td>
<td>Guaranteed monotonic WoE profile for regulatory compliance.</td>
</tr>
<tr class="odd">
<td><strong>Large datasets (&gt;1M rows)</strong></td>
<td>
<code>sketch</code>, <code>ewb</code>
</td>
<td>Constant or sublinear memory footprint.</td>
</tr>
<tr class="even">
<td><strong>Non-linear associations</strong></td>
<td>
<code>dp</code>, <code>cm</code>
</td>
<td>Optimal partitioning (Dynamic Programming) capturing complex
trends.</td>
</tr>
<tr class="odd">
<td><strong>Mixed data types</strong></td>
<td>
<code>jedi_mwoe</code>, <code>udt</code>
</td>
<td>Handles both numerical and categorical features uniformly.</td>
</tr>
<tr class="even">
<td><strong>Outlier robustness</strong></td>
<td>
<code>mdlp</code>, <code>fetb</code>
</td>
<td>Entropy-based discretization less sensitive to extreme values.</td>
</tr>
<tr class="odd">
<td><strong>Sparse categorical data</strong></td>
<td>
<code>gmb</code>, <code>ivb</code>, <code>swb</code>
</td>
<td>Groups infrequent categories based on similar risk profiles.</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="complete-algorithm-list-36-algorithms">Complete Algorithm List (36 Algorithms)<a class="anchor" aria-label="anchor" href="#complete-algorithm-list-36-algorithms"></a>
</h4>
<table class="table">
<colgroup>
<col width="33%">
<col width="66%">
</colgroup>
<thead><tr class="header">
<th>Type</th>
<th>Algorithms</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Universal (9)</strong></td>
<td>
<code>jedi</code>, <code>jedi_mwoe</code>, <code>cm</code>,
<code>dp</code>, <code>dmiv</code>, <code>fetb</code>, <code>mob</code>,
<code>sketch</code>, <code>udt</code>
</td>
</tr>
<tr class="even">
<td><strong>Numerical (12)</strong></td>
<td>
<code>bb</code>, <code>ewb</code>, <code>fast_mdlp</code>,
<code>ir</code>, <code>kmb</code>, <code>ldb</code>, <code>lpdb</code>,
<code>mblp</code>, <code>mdlp</code>, <code>mrblp</code>,
<code>oslp</code>, <code>ubsd</code>
</td>
</tr>
<tr class="odd">
<td><strong>Categorical (15)</strong></td>
<td>
<code>gmb</code>, <code>ivb</code>, <code>mba</code>,
<code>milp</code>, <code>sab</code>, <code>sblp</code>, <code>swb</code>
(and others)</td>
</tr>
</tbody>
</table>
<p><em>Full mapping can be inspected via
<code><a href="../reference/obwoe_algorithms.html">obwoe_algorithms()</a></code>.</em></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="production-pipeline-with-tidymodels">Production Pipeline with tidymodels<a class="anchor" aria-label="anchor" href="#production-pipeline-with-tidymodels"></a>
</h2>
<p>The most powerful application is integrating WoE into production ML
workflows.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train/test split with stratification</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">german_split</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">german_model</span>, prop <span class="op">=</span> <span class="fl">0.7</span>, strata <span class="op">=</span> <span class="va">default</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">german_split</span><span class="op">)</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">german_split</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Training set:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">)</span>, <span class="st">"observations\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Training set: 699 observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Test set:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, <span class="st">"observations\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test set: 301 observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Train default rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">$</span><span class="va">default</span> <span class="op">==</span> <span class="st">"bad"</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Train default rate: 30.04 %</span></span></code></pre></div>
<div class="section level3">
<h3 id="define-preprocessing-recipe">Define Preprocessing Recipe<a class="anchor" aria-label="anchor" href="#define-preprocessing-recipe"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create recipe with WoE transformation</span></span>
<span><span class="va">rec_woe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">default</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/step_obwoe.html">step_obwoe</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    outcome <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>    algorithm <span class="op">=</span> <span class="st">"jedi"</span>,</span>
<span>    min_bins <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    max_bins <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>, <span class="co"># Hyperparameter tuning</span></span>
<span>    bin_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"woe"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Preview recipe</span></span>
<span><span class="va">rec_woe</span></span>
<span><span class="co">#&gt; Optimal Binning WoE (all_predictors()) [algorithm='jedi']</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-specification-and-workflow">Model Specification and Workflow<a class="anchor" aria-label="anchor" href="#model-specification-and-workflow"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Logistic regression specification</span></span>
<span><span class="va">lr_spec</span> <span class="op">&lt;-</span> <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create complete workflow</span></span>
<span><span class="va">wf_credit</span> <span class="op">&lt;-</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">rec_woe</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">lr_spec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wf_credit</span></span>
<span><span class="co">#&gt; ══ Workflow ════════════════════════════════════════════════════════════════════</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Preprocessor:</span> Recipe</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Model:</span> logistic_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Preprocessor ────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; 1 Recipe Step</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • step_obwoe()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Model ───────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Logistic Regression Model Specification (classification)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational engine: glm</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hyperparameter-tuning">Hyperparameter Tuning<a class="anchor" aria-label="anchor" href="#hyperparameter-tuning"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define tuning grid</span></span>
<span><span class="va">tune_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>max_bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create cross-validation folds</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">cv_folds</span> <span class="op">&lt;-</span> <span class="fu">vfold_cv</span><span class="op">(</span><span class="va">train_data</span>, v <span class="op">=</span> <span class="fl">5</span>, strata <span class="op">=</span> <span class="va">default</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tune workflow</span></span>
<span><span class="va">tune_results</span> <span class="op">&lt;-</span> <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>  <span class="va">wf_credit</span>,</span>
<span>  resamples <span class="op">=</span> <span class="va">cv_folds</span>,</span>
<span>  grid <span class="op">=</span> <span class="va">tune_grid</span>,</span>
<span>  metrics <span class="op">=</span> <span class="fu">metric_set</span><span class="op">(</span><span class="va">roc_auc</span>, <span class="va">accuracy</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Best configuration</span></span>
<span><span class="fu">collect_metrics</span><span class="op">(</span><span class="va">tune_results</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># filter(.metric == "roc_auc") %&gt;%</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   max_bins .metric  .estimator  mean     n std_err .config        </span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>        4 roc_auc  binary     0.783     5 0.016<span style="text-decoration: underline;">8</span>  pre1_mod0_post0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>        6 roc_auc  binary     0.783     5 0.017<span style="text-decoration: underline;">6</span>  pre2_mod0_post0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>        8 roc_auc  binary     0.782     5 0.017<span style="text-decoration: underline;">7</span>  pre3_mod0_post0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>        6 accuracy binary     0.752     5 0.009<span style="text-decoration: underline;">55</span> pre2_mod0_post0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>        8 accuracy binary     0.751     5 0.009<span style="text-decoration: underline;">74</span> pre3_mod0_post0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>        4 accuracy binary     0.745     5 0.008<span style="text-decoration: underline;">54</span> pre1_mod0_post0</span></span>
<span></span>
<span><span class="co"># Visualize tuning</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">tune_results</span>, metric <span class="op">=</span> <span class="st">"roc_auc"</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/cv_tuning-1.png" class="r-plt" alt="" width="768"></p>
</div>
<div class="section level3">
<h3 id="final-model-fitting">Final Model Fitting<a class="anchor" aria-label="anchor" href="#final-model-fitting"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select best parameters</span></span>
<span><span class="va">best_params</span> <span class="op">&lt;-</span> <span class="fu">select_best</span><span class="op">(</span><span class="va">tune_results</span>, metric <span class="op">=</span> <span class="st">"roc_auc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Optimal max_bins:"</span>, <span class="va">best_params</span><span class="op">$</span><span class="va">max_bins</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Optimal max_bins: 4</span></span>
<span></span>
<span><span class="co"># Finalize and fit</span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">wf_credit</span>, <span class="va">best_params</span><span class="op">)</span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> <span class="fu">fit</span><span class="op">(</span><span class="va">final_wf</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract coefficients</span></span>
<span><span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">extract_fit_parsnip</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 5</span></span></span>
<span><span class="co">#&gt;   term                                estimate std.error statistic  p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> purpose                                1.00      0.233      4.29 1.76<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> savings.account.and.bonds              0.911     0.236      3.86 1.12<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> (Intercept)                           -<span style="color: #BB0000;">0.830</span>     0.100     -<span style="color: #BB0000;">8.29</span> 1.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-16</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> age.in.years                           0.824     0.289      2.85 4.36<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> status.of.existing.checking.account    0.811     0.117      6.93 4.22<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> credit.history                         0.748     0.167      4.48 7.63<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> credit.amount                          0.726     0.312      2.33 1.99<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> duration.in.month                      0.704     0.200      3.51 4.42<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-evaluation">Model Evaluation<a class="anchor" aria-label="anchor" href="#model-evaluation"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Predictions on test set</span></span>
<span><span class="va">test_pred</span> <span class="op">&lt;-</span> <span class="fu">augment</span><span class="op">(</span><span class="va">final_fit</span>, <span class="va">test_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Performance metrics</span></span>
<span><span class="va">metrics</span> <span class="op">&lt;-</span> <span class="fu">metric_set</span><span class="op">(</span><span class="va">roc_auc</span>, <span class="va">accuracy</span>, <span class="va">sens</span>, <span class="va">spec</span>, <span class="va">precision</span><span class="op">)</span></span>
<span><span class="fu">metrics</span><span class="op">(</span><span class="va">test_pred</span>,</span>
<span>  truth <span class="op">=</span> <span class="va">default</span>, estimate <span class="op">=</span> <span class="va">.pred_class</span>,</span>
<span>  <span class="va">.pred_bad</span>, event_level <span class="op">=</span> <span class="st">"second"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;   .metric   .estimator .estimate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> accuracy  binary         0.681</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> sens      binary         0.344</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> spec      binary         0.825</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> precision binary         0.456</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> roc_auc   binary         0.732</span></span>
<span></span>
<span><span class="co"># ROC curve</span></span>
<span><span class="fu">roc_curve</span><span class="op">(</span><span class="va">test_pred</span>,</span>
<span>  truth <span class="op">=</span> <span class="va">default</span>, <span class="va">.pred_bad</span>,</span>
<span>  event_level <span class="op">=</span> <span class="st">"second"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">autoplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"ROC Curve - German Credit Model"</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/model_eval-1.png" class="r-plt" alt="" width="768"></p>
</div>
<div class="section level3">
<h3 id="inspect-learned-binning-rules">Inspect Learned Binning Rules<a class="anchor" aria-label="anchor" href="#inspect-learned-binning-rules"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract trained recipe</span></span>
<span><span class="va">trained_rec</span> <span class="op">&lt;-</span> <span class="fu">extract_recipe</span><span class="op">(</span><span class="va">final_fit</span><span class="op">)</span></span>
<span><span class="va">woe_step</span> <span class="op">&lt;-</span> <span class="va">trained_rec</span><span class="op">$</span><span class="va">steps</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># View binning for credit.amount</span></span>
<span><span class="va">credit_bins</span> <span class="op">&lt;-</span> <span class="va">woe_step</span><span class="op">$</span><span class="va">binning_results</span><span class="op">$</span><span class="va">credit.amount</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Bin <span class="op">=</span> <span class="va">credit_bins</span><span class="op">$</span><span class="va">bin</span>,</span>
<span>  WoE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">credit_bins</span><span class="op">$</span><span class="va">woe</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  IV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">credit_bins</span><span class="op">$</span><span class="va">iv</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;                         Bin     WoE     IV</span></span>
<span><span class="co">#&gt; 1         (-Inf;700.000000] -0.2156 0.0022</span></span>
<span><span class="co">#&gt; 2  (700.000000;3249.000000] -0.2041 0.0244</span></span>
<span><span class="co">#&gt; 3 (3249.000000;5954.000000]  0.0396 0.0003</span></span>
<span><span class="co">#&gt; 4        (5954.000000;+Inf]  0.7652 0.0935</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="traditional-scorecard-development">Traditional Scorecard Development<a class="anchor" aria-label="anchor" href="#traditional-scorecard-development"></a>
</h2>
<p>For traditional credit scorecards outside tidymodels.</p>
<div class="section level3">
<h3 id="train-test-split">Train-Test Split<a class="anchor" aria-label="anchor" href="#train-test-split"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">n_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">german_model</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_total</span>, size <span class="op">=</span> <span class="fl">0.7</span> <span class="op">*</span> <span class="va">n_total</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_sc</span> <span class="op">&lt;-</span> <span class="va">german_model</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_sc</span> <span class="op">&lt;-</span> <span class="va">german_model</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-optimal-binning">Fit Optimal Binning<a class="anchor" aria-label="anchor" href="#fit-optimal-binning"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use monotonic binning for regulatory compliance</span></span>
<span><span class="va">sc_binning</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe.html">obwoe</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">train_sc</span>,</span>
<span>  target <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"mob"</span>, <span class="co"># Monotonic Optimal Binning</span></span>
<span>  min_bins <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_bins <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="../reference/control.obwoe.html">control.obwoe</a></span><span class="op">(</span></span>
<span>    bin_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    convergence_threshold <span class="op">=</span> <span class="fl">1e-6</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sc_binning</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary: Optimal Binning Weight of Evidence</span></span>
<span><span class="co">#&gt; ============================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target: default ( binary )</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Aggregate Statistics:</span></span>
<span><span class="co">#&gt;   Features: 7 total, 7 successful, 0 errors</span></span>
<span><span class="co">#&gt;   Total IV: 1.8858</span></span>
<span><span class="co">#&gt;   Mean IV: 0.2694 (SD: 0.3355)</span></span>
<span><span class="co">#&gt;   Median IV: 0.1432</span></span>
<span><span class="co">#&gt;   IV Range: [0.0005, 0.9570]</span></span>
<span><span class="co">#&gt;   Mean Bins: 3.7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; IV Classification (Siddiqi, 2006):</span></span>
<span><span class="co">#&gt;   Unpredictive: 2 features</span></span>
<span><span class="co">#&gt;   Weak        : 1 features</span></span>
<span><span class="co">#&gt;   Medium      : 2 features</span></span>
<span><span class="co">#&gt;   Strong      : 1 features</span></span>
<span><span class="co">#&gt;   Suspicious  : 1 features</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Feature Details:</span></span>
<span><span class="co">#&gt;                              feature        type n_bins    total_iv</span></span>
<span><span class="co">#&gt;  status.of.existing.checking.account categorical      4 0.956958967</span></span>
<span><span class="co">#&gt;            savings.account.and.bonds categorical      5 0.411933550</span></span>
<span><span class="co">#&gt;                       credit.history categorical      5 0.260486195</span></span>
<span><span class="co">#&gt;                    duration.in.month   numerical      3 0.143223080</span></span>
<span><span class="co">#&gt;                              purpose categorical      3 0.095403913</span></span>
<span><span class="co">#&gt;                         age.in.years   numerical      3 0.017231668</span></span>
<span><span class="co">#&gt;                        credit.amount   numerical      3 0.000523977</span></span>
<span><span class="co">#&gt;      iv_class</span></span>
<span><span class="co">#&gt;    Suspicious</span></span>
<span><span class="co">#&gt;        Strong</span></span>
<span><span class="co">#&gt;        Medium</span></span>
<span><span class="co">#&gt;        Medium</span></span>
<span><span class="co">#&gt;          Weak</span></span>
<span><span class="co">#&gt;  Unpredictive</span></span>
<span><span class="co">#&gt;  Unpredictive</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="apply-woe-transformation">Apply WoE Transformation<a class="anchor" aria-label="anchor" href="#apply-woe-transformation"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Transform training data with error handling</span></span>
<span><span class="va">train_woe</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/obwoe_apply.html">obwoe_apply</a></span><span class="op">(</span><span class="va">train_sc</span>, <span class="va">sc_binning</span>, keep_original <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Error in obwoe_apply for training data: "</span>, <span class="va">e</span><span class="op">$</span><span class="va">message</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"This may occur with certain data distributions. Skipping transformation."</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Only proceed if transformation succeeded</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">train_woe</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Transform test data (uses training bins)</span></span>
<span>  <span class="va">test_woe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe_apply.html">obwoe_apply</a></span><span class="op">(</span><span class="va">test_sc</span>, <span class="va">sc_binning</span>, keep_original <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Preview transformed features</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">train_woe</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"default"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_woe$"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">train_woe</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Skipping WoE transformation demonstration due to data incompatibility."</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;    default duration.in.month_woe credit.amount_woe age.in.years_woe</span></span>
<span><span class="co">#&gt; 1      bad             0.1024181      -0.002787588      -0.04548908</span></span>
<span><span class="co">#&gt; 2     good             0.1024181      -0.002787588      -0.04548908</span></span>
<span><span class="co">#&gt; 3     good             0.1024181       0.054981244      -0.04548908</span></span>
<span><span class="co">#&gt; 4     good             0.1024181      -0.002787588      -0.04548908</span></span>
<span><span class="co">#&gt; 5     good             0.1024181      -0.002787588      -0.04548908</span></span>
<span><span class="co">#&gt; 6     good             0.1024181      -0.002787588      -0.04548908</span></span>
<span><span class="co">#&gt; 7     good             0.1024181      -0.002787588       0.31220411</span></span>
<span><span class="co">#&gt; 8     good             0.1024181       0.054981244      -0.04548908</span></span>
<span><span class="co">#&gt; 9     good             0.1024181      -0.002787588      -0.04548908</span></span>
<span><span class="co">#&gt; 10    good             0.1024181      -0.002787588      -0.04548908</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="build-logistic-regression">Build Logistic Regression<a class="anchor" aria-label="anchor" href="#build-logistic-regression"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">train_woe</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Select features with IV &gt;= 0.02</span></span>
<span>  <span class="va">selected</span> <span class="op">&lt;-</span> <span class="va">sc_binning</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">feature</span><span class="op">[</span></span>
<span>    <span class="va">sc_binning</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">total_iv</span> <span class="op">&gt;=</span> <span class="fl">0.02</span> <span class="op">&amp;</span></span>
<span>      <span class="op">!</span><span class="va">sc_binning</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">error</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span>  <span class="va">woe_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">selected</span>, <span class="st">"_woe"</span><span class="op">)</span></span>
<span>  <span class="va">formula_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"default ~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">woe_vars</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Fit model</span></span>
<span>  <span class="va">scorecard_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="va">formula_str</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">train_woe</span>,</span>
<span>    family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scorecard_glm</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Skipping model building - WoE transformation failed."</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = as.formula(formula_str), family = binomial(link = "logit"), </span></span>
<span><span class="co">#&gt;     data = train_woe)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                                         Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)                             -0.79374    0.09883  -8.031 9.65e-16</span></span>
<span><span class="co">#&gt; duration.in.month_woe                    0.72740    0.23363   3.114 0.001849</span></span>
<span><span class="co">#&gt; status.of.existing.checking.account_woe  0.89237    0.10413   8.570  &lt; 2e-16</span></span>
<span><span class="co">#&gt; credit.history_woe                       0.74937    0.19002   3.944 8.03e-05</span></span>
<span><span class="co">#&gt; purpose_woe                              1.02008    0.30818   3.310 0.000933</span></span>
<span><span class="co">#&gt; savings.account.and.bonds_woe            0.75047    0.19641   3.821 0.000133</span></span>
<span><span class="co">#&gt;                                            </span></span>
<span><span class="co">#&gt; (Intercept)                             ***</span></span>
<span><span class="co">#&gt; duration.in.month_woe                   ** </span></span>
<span><span class="co">#&gt; status.of.existing.checking.account_woe ***</span></span>
<span><span class="co">#&gt; credit.history_woe                      ***</span></span>
<span><span class="co">#&gt; purpose_woe                             ***</span></span>
<span><span class="co">#&gt; savings.account.and.bonds_woe           ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 860.23  on 699  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 665.59  on 694  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 677.59</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="scorecard-validation">Scorecard Validation<a class="anchor" aria-label="anchor" href="#scorecard-validation"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">train_woe</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"scorecard_glm"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/" class="external-link">pROC</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Predictions</span></span>
<span>  <span class="va">test_woe</span><span class="op">$</span><span class="va">score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">scorecard_glm</span>, newdata <span class="op">=</span> <span class="va">test_woe</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># ROC curve</span></span>
<span>  <span class="va">roc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></span><span class="op">(</span><span class="va">test_woe</span><span class="op">$</span><span class="va">default</span>, <span class="va">test_woe</span><span class="op">$</span><span class="va">score</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">auc_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></span><span class="op">(</span><span class="va">roc_obj</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># KS statistic</span></span>
<span>  <span class="va">ks_stat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">test_woe</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">test_woe</span><span class="op">$</span><span class="va">default</span> <span class="op">==</span> <span class="st">"bad"</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">test_woe</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">test_woe</span><span class="op">$</span><span class="va">default</span> <span class="op">==</span> <span class="st">"good"</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Gini coefficient</span></span>
<span>  <span class="va">gini</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">auc_val</span> <span class="op">-</span> <span class="fl">1</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Scorecard Performance:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  AUC:  "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">auc_val</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Gini: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">gini</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  KS:   "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ks_stat</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># ROC plot</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">roc_obj</span>,</span>
<span>    main <span class="op">=</span> <span class="st">"Scorecard ROC Curve"</span>,</span>
<span>    print.auc <span class="op">=</span> <span class="cn">TRUE</span>, print.thres <span class="op">=</span> <span class="st">"best"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Skipping validation - model not available."</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Scorecard Performance:</span></span>
<span><span class="co">#&gt;   AUC:   0.6504 </span></span>
<span><span class="co">#&gt;   Gini:  0.3007 </span></span>
<span><span class="co">#&gt;   KS:    29.93 %</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/scorecard_validation-1.png" class="r-plt" alt="" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="data-preprocessing">Data Preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h2>
<p>Proper preprocessing improves binning quality.</p>
<div class="section level3">
<h3 id="handling-missing-values-and-outliers">Handling Missing Values and Outliers<a class="anchor" aria-label="anchor" href="#handling-missing-values-and-outliers"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate feature with issues</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span>
<span><span class="va">problematic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">800</span>, <span class="fl">5000</span>, <span class="fl">2000</span><span class="op">)</span>, <span class="co"># Normal values</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">100</span><span class="op">)</span>, <span class="co"># Missing</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">10000</span>, <span class="fl">50000</span><span class="op">)</span> <span class="co"># Outliers</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">target_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Preprocess with IQR method</span></span>
<span><span class="va">preproc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ob_preprocess.html">ob_preprocess</a></span><span class="op">(</span></span>
<span>  feature <span class="op">=</span> <span class="va">problematic</span>,</span>
<span>  target <span class="op">=</span> <span class="va">target_sim</span>,</span>
<span>  outlier_method <span class="op">=</span> <span class="st">"iqr"</span>,</span>
<span>  outlier_process <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  preprocess <span class="op">=</span> <span class="st">"both"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View report</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">preproc_result</span><span class="op">$</span><span class="va">report</span><span class="op">)</span></span>
<span><span class="co">#&gt;   variable_type missing_count outlier_count</span></span>
<span><span class="co">#&gt; 1       numeric           100            73</span></span>
<span><span class="co">#&gt;                                                                                                       original_stats</span></span>
<span><span class="co">#&gt; 1 { min: -8995.151324, Q1: 3697.784305, median: 5113.928039, mean: 6625.179803, Q3: 6705.149551, max: 49477.654407 }</span></span>
<span><span class="co">#&gt;                                                                                                   preprocessed_stats</span></span>
<span><span class="co">#&gt; 1 { min: -2161.216958, Q1: 3042.732437, median: 4792.608602, mean: 4703.116058, Q3: 6517.601547, max: 11703.913644 }</span></span>
<span></span>
<span><span class="co"># Compare distributions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\nBefore preprocessing:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Before preprocessing:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Range:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">problematic</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Range: -2161.217 11703.91</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Missing:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">problematic</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Missing: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">problematic</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean: 4703.12</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nAfter preprocessing:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; After preprocessing:</span></span>
<span><span class="va">cleaned</span> <span class="op">&lt;-</span> <span class="va">preproc_result</span><span class="op">$</span><span class="va">preprocess</span><span class="op">$</span><span class="va">feature_preprocessed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Range:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">cleaned</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Range: -2161.217 11703.91</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Missing:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cleaned</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Missing: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cleaned</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean: 4703.12</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="production-deployment">Production Deployment<a class="anchor" aria-label="anchor" href="#production-deployment"></a>
</h2>
<div class="section level3">
<h3 id="model-serialization">Model Serialization<a class="anchor" aria-label="anchor" href="#model-serialization"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add metadata to model</span></span>
<span><span class="va">sc_binning</span><span class="op">$</span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  creation_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  creator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.info.html" class="external-link">Sys.info</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"user"</span><span class="op">]</span>,</span>
<span>  dataset_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">train_sc</span><span class="op">)</span>,</span>
<span>  default_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">train_sc</span><span class="op">$</span><span class="va">default</span> <span class="op">==</span> <span class="st">"bad"</span><span class="op">)</span>,</span>
<span>  r_version <span class="op">=</span> <span class="va">R.version.string</span>,</span>
<span>  package_version <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"OptimalBinningWoE"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">sc_binning</span>, <span class="st">"credit_scorecard_v1_20250101.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load model</span></span>
<span><span class="va">loaded_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"credit_scorecard_v1_20250101.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="production-scoring-function">Production Scoring Function<a class="anchor" aria-label="anchor" href="#production-scoring-function"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">score_applications</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">new_data</span>, <span class="va">model_file</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Load binning model</span></span>
<span>  <span class="va">binning_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">model_file</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Validate required features</span></span>
<span>  <span class="va">required_vars</span> <span class="op">&lt;-</span> <span class="va">binning_model</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">feature</span><span class="op">[</span></span>
<span>    <span class="op">!</span><span class="va">binning_model</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">error</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span>  <span class="va">missing_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">required_vars</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">new_data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">missing_vars</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Missing features: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">missing_vars</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Apply WoE transformation</span></span>
<span>  <span class="va">scored</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe_apply.html">obwoe_apply</a></span><span class="op">(</span><span class="va">new_data</span>, <span class="va">binning_model</span>, keep_original <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Add timestamp</span></span>
<span>  <span class="va">scored</span><span class="op">$</span><span class="va">scoring_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">scored</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Usage example</span></span>
<span><span class="co"># new_apps &lt;- read.csv("new_applications.csv")</span></span>
<span><span class="co"># scored_apps &lt;- score_applications(new_apps, "credit_scorecard_v1_20250101.rds")</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="best-practices-summary">Best Practices Summary<a class="anchor" aria-label="anchor" href="#best-practices-summary"></a>
</h2>
<div class="section level3">
<h3 id="workflow-recommendations">Workflow Recommendations<a class="anchor" aria-label="anchor" href="#workflow-recommendations"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Start Simple</strong>: Use <code>algorithm = "jedi"</code>
as default</li>
<li>
<strong>Check IV</strong>: Select features with IV ≥ 0.02</li>
<li>
<strong>Validate Monotonicity</strong>: Use MOB/MBLP for regulatory
models</li>
<li>
<strong>Cross-Validate</strong>: Tune binning parameters with
CV</li>
<li>
<strong>Monitor Stability</strong>: Track WoE distributions over
time</li>
<li>
<strong>Document Thoroughly</strong>: Save metadata with models</li>
</ol>
</div>
<div class="section level3">
<h3 id="common-pitfalls-to-avoid">Common Pitfalls to Avoid<a class="anchor" aria-label="anchor" href="#common-pitfalls-to-avoid"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ❌ Don't bin on full dataset before splitting</span></span>
<span><span class="co"># This causes data leakage!</span></span>
<span><span class="va">bad_approach</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe.html">obwoe</a></span><span class="op">(</span><span class="va">full_data</span>, target <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="va">train_woe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe_apply.html">obwoe_apply</a></span><span class="op">(</span><span class="va">train_data</span>, <span class="va">bad_approach</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ✅ Correct: Bin only on training data</span></span>
<span><span class="va">good_approach</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe.html">obwoe</a></span><span class="op">(</span><span class="va">train_data</span>, target <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="va">test_woe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obwoe_apply.html">obwoe_apply</a></span><span class="op">(</span><span class="va">test_data</span>, <span class="va">good_approach</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ❌ Don't ignore IV thresholds</span></span>
<span><span class="co"># IV &gt; 0.50 likely indicates target leakage</span></span>
<span><span class="va">suspicious_features</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">feature</span><span class="op">[</span></span>
<span>  <span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">total_iv</span> <span class="op">&gt;</span> <span class="fl">0.50</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="co"># ❌ Don't over-bin</span></span>
<span><span class="co"># Too many bins (&gt;10) reduces interpretability</span></span>
<span><span class="co"># and may cause overfitting</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Siddiqi, N. (2006). <em>Credit Risk Scorecards: Developing and
Implementing Intelligent Credit Scoring</em>. John Wiley &amp; Sons.</p>
<p>Thomas, L. C., Edelman, D. B., &amp; Crook, J. N. (2002). <em>Credit
Scoring and Its Applications</em>. SIAM.</p>
<p>Navas-Palencia, G. (2020). Optimal Binning: Mathematical Programming
Formulation. <em>Expert Systems with Applications</em>, 158, 113508.</p>
<p>Anderson, R. (2007). <em>The Credit Scoring Toolkit: Theory and
Practice for Retail Credit Risk Management</em>. Oxford University
Press.</p>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] pROC_1.19.0.1           yardstick_1.3.2         workflowsets_1.1.1     </span></span>
<span><span class="co">#&gt;  [4] workflows_1.3.0         tune_2.0.1              tidyr_1.3.2            </span></span>
<span><span class="co">#&gt;  [7] tailor_0.1.0            rsample_1.3.1           recipes_1.3.1          </span></span>
<span><span class="co">#&gt; [10] purrr_1.2.1             parsnip_1.4.1           modeldata_1.5.1        </span></span>
<span><span class="co">#&gt; [13] infer_1.1.0             ggplot2_4.0.1           dplyr_1.1.4            </span></span>
<span><span class="co">#&gt; [16] dials_1.4.2             scales_1.4.0            broom_1.0.11           </span></span>
<span><span class="co">#&gt; [19] tidymodels_1.4.1        scorecard_0.4.5         OptimalBinningWoE_1.0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gridExtra_2.3       rlang_1.1.7         magrittr_2.0.4     </span></span>
<span><span class="co">#&gt;  [4] furrr_0.3.1         compiler_4.5.2      systemfonts_1.3.1  </span></span>
<span><span class="co">#&gt;  [7] vctrs_0.7.1         lhs_1.2.0           pkgconfig_2.0.3    </span></span>
<span><span class="co">#&gt; [10] fastmap_1.2.0       backports_1.5.0     labeling_0.4.3     </span></span>
<span><span class="co">#&gt; [13] utf8_1.2.6          rmarkdown_2.30      prodlim_2025.04.28 </span></span>
<span><span class="co">#&gt; [16] ragg_1.5.0          xfun_0.56           cachem_1.1.0       </span></span>
<span><span class="co">#&gt; [19] jsonlite_2.0.0      parallel_4.5.2      R6_2.6.1           </span></span>
<span><span class="co">#&gt; [22] bslib_0.9.0         stringi_1.8.7       RColorBrewer_1.1-3 </span></span>
<span><span class="co">#&gt; [25] parallelly_1.46.1   rpart_4.1.24        lubridate_1.9.4    </span></span>
<span><span class="co">#&gt; [28] jquerylib_0.1.4     Rcpp_1.1.1          iterators_1.0.14   </span></span>
<span><span class="co">#&gt; [31] knitr_1.51          future.apply_1.20.1 Matrix_1.7-4       </span></span>
<span><span class="co">#&gt; [34] splines_4.5.2       nnet_7.3-20         timechange_0.3.0   </span></span>
<span><span class="co">#&gt; [37] tidyselect_1.2.1    rstudioapi_0.18.0   yaml_2.3.12        </span></span>
<span><span class="co">#&gt; [40] timeDate_4051.111   doParallel_1.0.17   codetools_0.2-20   </span></span>
<span><span class="co">#&gt; [43] listenv_0.10.0      lattice_0.22-7      tibble_3.3.1       </span></span>
<span><span class="co">#&gt; [46] withr_3.0.2         S7_0.2.1            evaluate_1.0.5     </span></span>
<span><span class="co">#&gt; [49] future_1.69.0       desc_1.4.3          survival_3.8-3     </span></span>
<span><span class="co">#&gt; [52] zip_2.3.3           xml2_1.5.2          pillar_1.11.1      </span></span>
<span><span class="co">#&gt; [55] foreach_1.5.2       generics_0.1.4      globals_0.18.0     </span></span>
<span><span class="co">#&gt; [58] class_7.3-23        glue_1.8.0          tools_4.5.2        </span></span>
<span><span class="co">#&gt; [61] data.table_1.18.0   openxlsx_4.2.8.1    gower_1.0.2        </span></span>
<span><span class="co">#&gt; [64] fs_1.6.6            grid_4.5.2          ipred_0.9-15       </span></span>
<span><span class="co">#&gt; [67] xefun_0.1.5         cli_3.6.5           DiceDesign_1.10    </span></span>
<span><span class="co">#&gt; [70] textshaping_1.0.4   lava_1.8.2          gtable_0.3.6       </span></span>
<span><span class="co">#&gt; [73] GPfit_1.0-9         sass_0.4.10         digest_0.6.39      </span></span>
<span><span class="co">#&gt; [76] farver_2.1.2        htmltools_0.5.9     pkgdown_2.2.0      </span></span>
<span><span class="co">#&gt; [79] lifecycle_1.0.5     hardhat_1.4.2       MASS_7.3-65        </span></span>
<span><span class="co">#&gt; [82] sparsevctrs_0.3.5</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by José Evandeilton Lopes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
