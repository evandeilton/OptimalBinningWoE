<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal Binning and WoE Transformation Step — step_obwoe • OptimalBinningWoE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Binning and WoE Transformation Step — step_obwoe"><meta name="description" content="step_obwoe() creates a specification of a recipe step that
discretizes predictor variables using one of 28 state-of-the-art optimal
binning algorithms and transforms them into Weight of Evidence (WoE) values.
This step fully integrates the OptimalBinningWoE package into the
tidymodels framework, supporting supervised discretization for both
binary and multinomial classification targets with extensive hyperparameter
tuning capabilities."><meta property="og:description" content="step_obwoe() creates a specification of a recipe step that
discretizes predictor variables using one of 28 state-of-the-art optimal
binning algorithms and transforms them into Weight of Evidence (WoE) values.
This step fully integrates the OptimalBinningWoE package into the
tidymodels framework, supporting supervised discretization for both
binary and multinomial classification targets with extensive hyperparameter
tuning capabilities."><meta property="og:image" content="https://evandeilton.github.io/OptimalBinningWoE/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OptimalBinningWoE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">OptimalBinningWoE: Practical Guide for Credit Risk Modeling</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/evandeilton/OptimalBinningWoE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Optimal Binning and WoE Transformation Step</h1>
      <small class="dont-index">Source: <a href="https://github.com/evandeilton/OptimalBinningWoE/blob/main/R/step_obwoe.R" class="external-link"><code>R/step_obwoe.R</code></a></small>
      <div class="d-none name"><code>step_obwoe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>step_obwoe()</code> creates a <em>specification</em> of a recipe step that
discretizes predictor variables using one of 28 state-of-the-art optimal
binning algorithms and transforms them into Weight of Evidence (WoE) values.
This step fully integrates the <strong>OptimalBinningWoE</strong> package into the
<code>tidymodels</code> framework, supporting supervised discretization for both
binary and multinomial classification targets with extensive hyperparameter
tuning capabilities.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">step_obwoe</span><span class="op">(</span></span>
<span>  <span class="va">recipe</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  role <span class="op">=</span> <span class="st">"predictor"</span>,</span>
<span>  trained <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  outcome <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  min_bins <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  max_bins <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  bin_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"woe"</span>, <span class="st">"bin"</span>, <span class="st">"both"</span><span class="op">)</span>,</span>
<span>  suffix_woe <span class="op">=</span> <span class="st">"_woe"</span>,</span>
<span>  suffix_bin <span class="op">=</span> <span class="st">"_bin"</span>,</span>
<span>  na_woe <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  binning_results <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  skip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  id <span class="op">=</span> <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/rand_id.html" class="external-link">rand_id</a></span><span class="op">(</span><span class="st">"obwoe"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-recipe">recipe<a class="anchor" aria-label="anchor" href="#arg-recipe"></a></dt>
<dd><p>A recipe object. The step will be added to the sequence of
operations for this recipe.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>One or more selector functions to choose variables for this step.
See <code><a href="https://recipes.tidymodels.org/reference/selections.html" class="external-link">selections</a></code> for available selectors. Common
choices include <code><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors()</a></code>, <code><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_numeric_predictors()</a></code>,
or <code><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_nominal_predictors()</a></code>. Ensure the selected variables are
compatible with the chosen <code>algorithm</code> (e.g., do not apply
<code>"mdlp"</code> to categorical data).</p></dd>


<dt id="arg-role">role<a class="anchor" aria-label="anchor" href="#arg-role"></a></dt>
<dd><p>For variables created by this step, what role should they have?</p>
<p>Default is <code>"predictor"</code>.</p></dd>


<dt id="arg-trained">trained<a class="anchor" aria-label="anchor" href="#arg-trained"></a></dt>
<dd><p>A logical indicating whether the step has been trained
(fitted). This should not be set manually.</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>A character string specifying the name of the binary or
multinomial response variable. This argument is <strong>required</strong> as all
binning algorithms are supervised. The outcome must exist in the training
data provided to <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep()</a></code>. The outcome should be encoded as a factor
(standard for tidymodels classification) or as integers 0/1 for binary,
0/1/2/... for multinomial.</p></dd>


<dt id="arg-algorithm">algorithm<a class="anchor" aria-label="anchor" href="#arg-algorithm"></a></dt>
<dd><p>Character string specifying the binning algorithm to use.
  Use <code>"auto"</code> (default) for automatic selection based on target type:
  <code>"jedi"</code> for binary targets, <code>"jedi_mwoe"</code> for multinomial.</p>
<p>Available algorithms are organized by supported feature types:</p>
<p><strong>Universal (numerical and categorical):</strong>
  <code>"auto"</code>, <code>"jedi"</code>, <code>"jedi_mwoe"</code>, <code>"cm"</code>, <code>"dp"</code>,
  <code>"dmiv"</code>, <code>"fetb"</code>, <code>"mob"</code>, <code>"sketch"</code>, <code>"udt"</code></p>
<p><strong>Numerical only:</strong>
  <code>"bb"</code>, <code>"ewb"</code>, <code>"fast_mdlp"</code>, <code>"ir"</code>, <code>"kmb"</code>,
  <code>"ldb"</code>, <code>"lpdb"</code>, <code>"mblp"</code>, <code>"mdlp"</code>, <code>"mrblp"</code>,
  <code>"oslp"</code>, <code>"ubsd"</code></p>
<p><strong>Categorical only:</strong>
  <code>"gmb"</code>, <code>"ivb"</code>, <code>"mba"</code>, <code>"milp"</code>, <code>"sab"</code>,
  <code>"sblp"</code>, <code>"swb"</code></p>
<p>This parameter is tunable with <code>tune()</code>.</p></dd>


<dt id="arg-min-bins">min_bins<a class="anchor" aria-label="anchor" href="#arg-min-bins"></a></dt>
<dd><p>Integer specifying the minimum number of bins to create.
Must be at least 2. Default is 2. This parameter is tunable with
<code>tune()</code>.</p></dd>


<dt id="arg-max-bins">max_bins<a class="anchor" aria-label="anchor" href="#arg-max-bins"></a></dt>
<dd><p>Integer specifying the maximum number of bins to create.
Must be greater than or equal to <code>min_bins</code>. Default is 10. This
parameter is tunable with <code>tune()</code>.</p></dd>


<dt id="arg-bin-cutoff">bin_cutoff<a class="anchor" aria-label="anchor" href="#arg-bin-cutoff"></a></dt>
<dd><p>Numeric value between 0 and 1 (exclusive) specifying the
minimum proportion of total observations that each bin must contain. Bins
with fewer observations are merged with adjacent bins. This serves as a
regularization mechanism to prevent overfitting and ensure statistical
stability of WoE estimates. Default is 0.05 (5%). This parameter is
tunable with <code>tune()</code>.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>Character string specifying the transformation output format:</p><dl><dt><code>"woe"</code></dt>
<dd><p>Replaces the original variable with WoE values
    (default). This is the standard choice for logistic regression
    scorecards.</p></dd>

  <dt><code>"bin"</code></dt>
<dd><p>Replaces the original variable with bin labels
    (character). Useful for tree-based models or exploratory analysis.</p></dd>

  <dt><code>"both"</code></dt>
<dd><p>Keeps the original column and adds two new columns
    with suffixes <code>_woe</code> and <code>_bin</code>. Useful for model comparison
    or audit trails.</p></dd>


</dl></dd>


<dt id="arg-suffix-woe">suffix_woe<a class="anchor" aria-label="anchor" href="#arg-suffix-woe"></a></dt>
<dd><p>Character string suffix appended to create WoE column names
when <code>output = "both"</code>. Default is <code>"_woe"</code>.</p></dd>


<dt id="arg-suffix-bin">suffix_bin<a class="anchor" aria-label="anchor" href="#arg-suffix-bin"></a></dt>
<dd><p>Character string suffix appended to create bin column names
when <code>output = "both"</code>. Default is <code>"_bin"</code>.</p></dd>


<dt id="arg-na-woe">na_woe<a class="anchor" aria-label="anchor" href="#arg-na-woe"></a></dt>
<dd><p>Numeric value to assign to observations that cannot be mapped
to a bin during <code><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake()</a></code>. This includes missing values (<code>NA</code>) and
unseen categories not present in the training data. Default is 0, which
represents neutral evidence (neither good nor bad).</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A named list of additional control parameters passed to
<code><a href="control.obwoe.html">control.obwoe</a></code>. These provide fine-grained control over
algorithm behavior such as convergence thresholds and maximum pre-bins.
Parameters specified directly in <code>step_obwoe()</code> (e.g.,
<code>bin_cutoff</code>) take precedence over values in this list.</p></dd>


<dt id="arg-binning-results">binning_results<a class="anchor" aria-label="anchor" href="#arg-binning-results"></a></dt>
<dd><p>Internal storage for fitted binning models after
<code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep()</a></code>. Do not set manually.</p></dd>


<dt id="arg-skip">skip<a class="anchor" aria-label="anchor" href="#arg-skip"></a></dt>
<dd><p>Logical. Should this step be skipped when <code><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake()</a></code> is
called on new data? Default is <code>FALSE</code>. Setting to <code>TRUE</code> is
rarely needed for WoE transformations but may be useful in specialized
workflows.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>A unique character string to identify this step. If not provided,
a random identifier is generated.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An updated <code>recipe</code> object with the new step appended.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="weight-of-evidence-transformation">Weight of Evidence Transformation<a class="anchor" aria-label="anchor" href="#weight-of-evidence-transformation"></a></h3>


<p>Weight of Evidence (WoE) is a supervised encoding technique that transforms
categorical and continuous variables into a scale that measures the
predictive strength of each value or bin relative to the target variable.
For a bin \(i\), the WoE is defined as:</p>
<p>$$WoE_i = \ln\left(\frac{\text{Distribution of Events}_i}{\text{Distribution of Non-Events}_i}\right)$$</p>
<p>Positive WoE values indicate the bin has a higher proportion of events
(e.g., defaults) than the overall population, while negative values indicate
lower risk.</p>
</div>

<div class="section">
<h3 id="algorithm-selection-strategy">Algorithm Selection Strategy<a class="anchor" aria-label="anchor" href="#algorithm-selection-strategy"></a></h3>


<p>The <code>algorithm</code> parameter provides access to 28 binning algorithms:</p>
<ul><li><p>Use <code>algorithm = "auto"</code> (default) for automatic selection:
    <code>"jedi"</code> for binary targets, <code>"jedi_mwoe"</code> for multinomial.</p></li>
<li><p>Use <code>algorithm = "mob"</code> (Monotonic Optimal Binning) when
    monotonic WoE trends are required for regulatory compliance (Basel/IFRS 9).</p></li>
<li><p>Use <code>algorithm = "mdlp"</code> for entropy-based discretization of
    numerical variables (requires <code><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_numeric_predictors()</a></code>).</p></li>
<li><p>Use <code>algorithm = "dp"</code> (Dynamic Programming) for exact optimal
    solutions when computational cost is acceptable.</p></li>
</ul><p>If an incompatible algorithm is applied to a variable (e.g., <code>"mdlp"</code>
on a factor), the step will issue a warning during <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep()</a></code> and skip
that variable, leaving it untransformed.</p>
</div>

<div class="section">
<h3 id="handling-new-data">Handling New Data<a class="anchor" aria-label="anchor" href="#handling-new-data"></a></h3>


<p>During <code><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake()</a></code>, observations are mapped to bins learned during
<code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep()</a></code>:</p>
<ul><li><p><strong>Numerical variables</strong>: Values are assigned to bins based on
    the learned cutpoints using interval notation.</p></li>
<li><p><strong>Categorical variables</strong>: Categories are matched to their
    corresponding bins. Categories not seen during training receive the
    <code>na_woe</code> value.</p></li>
<li><p><strong>Missing values</strong>: Always receive the <code>na_woe</code> value.</p></li>
</ul></div>

<div class="section">
<h3 id="tuning-with-tune">Tuning with tune<a class="anchor" aria-label="anchor" href="#tuning-with-tune"></a></h3>


<p>This step is fully compatible with the <code>tune</code> package. The following
parameters support <code>tune()</code>:</p>
<ul><li><p><code>algorithm</code>: See <code><a href="obwoe_algorithm.html">obwoe_algorithm</a></code>.</p></li>
<li><p><code>min_bins</code>: See <code><a href="obwoe_min_bins.html">obwoe_min_bins</a></code>.</p></li>
<li><p><code>max_bins</code>: See <code><a href="obwoe_max_bins.html">obwoe_max_bins</a></code>.</p></li>
<li><p><code>bin_cutoff</code>: See <code><a href="obwoe_bin_cutoff.html">obwoe_bin_cutoff</a></code>.</p></li>
</ul></div>

<div class="section">
<h3 id="case-weights">Case Weights<a class="anchor" aria-label="anchor" href="#case-weights"></a></h3>


<p>This step does not currently support case weights. All observations are
treated with equal weight during binning optimization.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Siddiqi, N. (2006). Credit Risk Scorecards: Developing and Implementing
Intelligent Credit Scoring. <em>John Wiley &amp; Sons</em>.
<a href="https://doi.org/10.1002/9781119201731" class="external-link">doi:10.1002/9781119201731</a></p>
<p>Thomas, L. C., Edelman, D. B., &amp; Crook, J. N. (2002). Credit Scoring
and Its Applications. <em>SIAM Monographs on Mathematical Modeling
and Computation</em>. <a href="https://doi.org/10.1137/1.9780898718317" class="external-link">doi:10.1137/1.9780898718317</a></p>
<p>Navas-Palencia, G. (2020). Optimal Binning: Mathematical Programming
Formulation and Solution Approach. <em>Expert Systems with Applications</em>,
158, 113508. <a href="https://doi.org/10.1016/j.eswa.2020.113508" class="external-link">doi:10.1016/j.eswa.2020.113508</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="obwoe.html">obwoe</a></code> for the underlying binning engine,
<code><a href="control.obwoe.html">control.obwoe</a></code> for advanced control parameters,
<code><a href="obwoe_algorithm.html">obwoe_algorithm</a></code>, <code><a href="obwoe_min_bins.html">obwoe_min_bins</a></code>,
<code><a href="obwoe_max_bins.html">obwoe_max_bins</a></code>, <code><a href="obwoe_bin_cutoff.html">obwoe_bin_cutoff</a></code> for tuning
parameter definitions,
<code><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></code>, <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></code>,
<code><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></code> for the tidymodels recipe framework.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes" class="external-link">recipes</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: dplyr</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘recipes’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     step</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulated credit data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">credit_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">45</span>, <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  income <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">10</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  employment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Employed"</span>, <span class="st">"Self-Employed"</span>, <span class="st">"Unemployed"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fl">500</span>,</span></span>
<span class="r-in"><span>    replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  education <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HighSchool"</span>, <span class="st">"Bachelor"</span>, <span class="st">"Master"</span>, <span class="st">"PhD"</span><span class="op">)</span><span class="op">[</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  default <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1</span>, <span class="fl">0.15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Yes"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Basic usage with automatic algorithm selection</span></span></span>
<span class="r-in"><span><span class="va">rec_basic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">default</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">credit_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">step_obwoe</span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span>, outcome <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rec_prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="va">rec_basic</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">baked_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="va">rec_prepped</span>, new_data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">baked_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        age income employment education default</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>   0.059<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.115</span>    0.007<span style="text-decoration: underline;">61</span>   -<span style="color: #BB0000;">0.094</span><span style="color: #BB0000; text-decoration: underline;">5</span> No     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>   0.059<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.115</span>    0.007<span style="text-decoration: underline;">61</span>   -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">9</span> Yes    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>   0.059<span style="text-decoration: underline;">9</span>  0.230    0.007<span style="text-decoration: underline;">61</span>   -<span style="color: #BB0000;">0.094</span><span style="color: #BB0000; text-decoration: underline;">5</span> No     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>   0.059<span style="text-decoration: underline;">9</span>  0.230    0.007<span style="text-decoration: underline;">61</span>   -<span style="color: #BB0000;">0.050</span><span style="color: #BB0000; text-decoration: underline;">4</span> No     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>   0.059<span style="text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.310</span>    0.007<span style="text-decoration: underline;">61</span>   -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">9</span> No     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> -<span style="color: #BB0000;">20.2</span>     0        0.007<span style="text-decoration: underline;">61</span>   -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">9</span> No     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View binning details</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">rec_prepped</span>, number <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 15 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    terms      bin                               woe        iv id         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> age        (-Inf;65.213228]              0.059<span style="text-decoration: underline;">9</span>  0.003<span style="text-decoration: underline;">48</span>   obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> age        (65.213228;+Inf]            -<span style="color: #BB0000;">20.2</span>     1.17      obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> income     (-Inf;11272.824005]          -<span style="color: #BB0000;">0.310</span>   0.012<span style="text-decoration: underline;">9</span>    obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> income     (11272.824005;20785.031269]  -<span style="color: #BB0000;">0.115</span>   0.003<span style="text-decoration: underline;">84</span>   obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> income     (20785.031269;24008.757553]   0       0         obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> income     (24008.757553;32373.582575]   0       0         obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> income     (32373.582575;59462.758585]   0.230   0.011<span style="text-decoration: underline;">4</span>    obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> income     (59462.758585;+Inf]           0.429   0.010<span style="text-decoration: underline;">7</span>    obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> employment Self-Employed                -<span style="color: #BB0000;">0.087</span><span style="color: #BB0000; text-decoration: underline;">3</span>  0.001<span style="text-decoration: underline;">36</span>   obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> employment Employed                      0.007<span style="text-decoration: underline;">61</span> 0.000<span style="text-decoration: underline;">040</span>9 obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> employment Unemployed                    0.038<span style="text-decoration: underline;">2</span>  0.000<span style="text-decoration: underline;">164</span>  obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> education  HighSchool                   -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">9</span>  0.002<span style="text-decoration: underline;">73</span>   obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> education  Master                       -<span style="color: #BB0000;">0.094</span><span style="color: #BB0000; text-decoration: underline;">5</span>  0.001<span style="text-decoration: underline;">87</span>   obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> education  Bachelor                     -<span style="color: #BB0000;">0.050</span><span style="color: #BB0000; text-decoration: underline;">4</span>  0.000<span style="text-decoration: underline;">965</span>  obwoe_sOPpR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> education  PhD                           0.490   0.029<span style="text-decoration: underline;">8</span>    obwoe_sOPpR</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Numerical-only algorithm on numeric predictors</span></span></span>
<span class="r-in"><span><span class="va">rec_mdlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">default</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">income</span>, data <span class="op">=</span> <span class="va">credit_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">step_obwoe</span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_numeric_predictors</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    outcome <span class="op">=</span> <span class="st">"default"</span>,</span></span>
<span class="r-in"><span>    algorithm <span class="op">=</span> <span class="st">"mdlp"</span>,</span></span>
<span class="r-in"><span>    min_bins <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    max_bins <span class="op">=</span> <span class="fl">6</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Output both bins and WoE</span></span></span>
<span class="r-in"><span><span class="va">rec_both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">default</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">credit_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">step_obwoe</span><span class="op">(</span><span class="va">age</span>,</span></span>
<span class="r-in"><span>    outcome <span class="op">=</span> <span class="st">"default"</span>,</span></span>
<span class="r-in"><span>    output <span class="op">=</span> <span class="st">"both"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">baked_both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="va">rec_both</span><span class="op">)</span>, new_data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">baked_both</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "age"     "age_woe" "age_bin" "default"</span>
<span class="r-in"><span><span class="co"># Contains: default, age, age_woe, age_bin</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4: Custom control parameters</span></span></span>
<span class="r-in"><span><span class="va">rec_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">default</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">credit_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">step_obwoe</span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    outcome <span class="op">=</span> <span class="st">"default"</span>,</span></span>
<span class="r-in"><span>    algorithm <span class="op">=</span> <span class="st">"mob"</span>,</span></span>
<span class="r-in"><span>    bin_cutoff <span class="op">=</span> <span class="fl">0.03</span>,</span></span>
<span class="r-in"><span>    control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      max_n_prebins <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>      convergence_threshold <span class="op">=</span> <span class="fl">1e-8</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 5: Tuning specification (for use with tune package)</span></span></span>
<span class="r-in"><span><span class="co"># rec_tune &lt;- recipe(default ~ ., data = credit_data) %&gt;%</span></span></span>
<span class="r-in"><span><span class="co">#   step_obwoe(all_predictors(),</span></span></span>
<span class="r-in"><span><span class="co">#              outcome = "default",</span></span></span>
<span class="r-in"><span><span class="co">#              algorithm = tune(),</span></span></span>
<span class="r-in"><span><span class="co">#              min_bins = tune(),</span></span></span>
<span class="r-in"><span><span class="co">#              max_bins = tune())</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by José Evandeilton Lopes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

