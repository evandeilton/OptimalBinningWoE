<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal Binning using Joint Entropy-Driven Interval Discretization (JEDI) — ob_numerical_jedi • OptimalBinningWoE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Binning using Joint Entropy-Driven Interval Discretization (JEDI) — ob_numerical_jedi"><meta name="description" content="Performs supervised discretization of continuous numerical variables using a
holistic approach that balances entropy reduction (information gain) with
statistical stability. The JEDI algorithm combines quantile-based initialization
with an iterative optimization process that enforces monotonicity and minimizes
Information Value (IV) loss."><meta property="og:description" content="Performs supervised discretization of continuous numerical variables using a
holistic approach that balances entropy reduction (information gain) with
statistical stability. The JEDI algorithm combines quantile-based initialization
with an iterative optimization process that enforces monotonicity and minimizes
Information Value (IV) loss."><meta property="og:image" content="https://evandeilton.github.io/OptimalBinningWoE/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OptimalBinningWoE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">OptimalBinningWoE: Practical Guide for Credit Risk Modeling</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/evandeilton/OptimalBinningWoE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Optimal Binning using Joint Entropy-Driven Interval Discretization (JEDI)</h1>
      <small class="dont-index">Source: <a href="https://github.com/evandeilton/OptimalBinningWoE/blob/main/R/obn_jedi.R" class="external-link"><code>R/obn_jedi.R</code></a></small>
      <div class="d-none name"><code>ob_numerical_jedi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs supervised discretization of continuous numerical variables using a
holistic approach that balances entropy reduction (information gain) with
statistical stability. The JEDI algorithm combines quantile-based initialization
with an iterative optimization process that enforces monotonicity and minimizes
Information Value (IV) loss.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ob_numerical_jedi</span><span class="op">(</span></span>
<span>  <span class="va">feature</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  min_bins <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_bins <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  bin_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  max_n_prebins <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  convergence_threshold <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-feature">feature<a class="anchor" aria-label="anchor" href="#arg-feature"></a></dt>
<dd><p>A numeric vector representing the continuous predictor variable.
Missing values (NA) should be handled prior to binning.</p></dd>


<dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>An integer vector of binary outcomes (0/1) corresponding to
each observation in <code>feature</code>. Must have the same length as <code>feature</code>.</p></dd>


<dt id="arg-min-bins">min_bins<a class="anchor" aria-label="anchor" href="#arg-min-bins"></a></dt>
<dd><p>Integer. The minimum number of bins to produce. Must be \(\ge\) 2.
Defaults to 3.</p></dd>


<dt id="arg-max-bins">max_bins<a class="anchor" aria-label="anchor" href="#arg-max-bins"></a></dt>
<dd><p>Integer. The maximum number of bins to produce. Must be \(\ge\)
<code>min_bins</code>. Defaults to 5.</p></dd>


<dt id="arg-bin-cutoff">bin_cutoff<a class="anchor" aria-label="anchor" href="#arg-bin-cutoff"></a></dt>
<dd><p>Numeric. The minimum fraction of total observations required
for a bin to be considered valid. Bins smaller than this threshold are merged.
Value must be in (0, 1). Defaults to 0.05.</p></dd>


<dt id="arg-max-n-prebins">max_n_prebins<a class="anchor" aria-label="anchor" href="#arg-max-n-prebins"></a></dt>
<dd><p>Integer. The number of initial quantiles to generate
during the initialization phase. Defaults to 20.</p></dd>


<dt id="arg-convergence-threshold">convergence_threshold<a class="anchor" aria-label="anchor" href="#arg-convergence-threshold"></a></dt>
<dd><p>Numeric. The threshold for the change in total IV
to determine convergence during the iterative optimization. Defaults to 1e-6.</p></dd>


<dt id="arg-max-iterations">max_iterations<a class="anchor" aria-label="anchor" href="#arg-max-iterations"></a></dt>
<dd><p>Integer. Safety limit for the maximum number of iterations.
Defaults to 1000.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the binning results:</p><ul><li><p><code>id</code>: Integer vector of bin identifiers.</p></li>
<li><p><code>bin</code>: Character vector of bin labels in interval notation.</p></li>
<li><p><code>woe</code>: Numeric vector of Weight of Evidence for each bin.</p></li>
<li><p><code>iv</code>: Numeric vector of Information Value contribution per bin.</p></li>
<li><p><code>count</code>: Integer vector of total observations per bin.</p></li>
<li><p><code>count_pos</code>: Integer vector of positive cases.</p></li>
<li><p><code>count_neg</code>: Integer vector of negative cases.</p></li>
<li><p><code>cutpoints</code>: Numeric vector of upper boundaries (excluding Inf).</p></li>
<li><p><code>converged</code>: Logical indicating if the algorithm converged.</p></li>
<li><p><code>iterations</code>: Integer count of iterations performed.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The JEDI algorithm is designed to be a robust "all-rounder" for credit scoring
and risk modeling. Its methodology proceeds in four distinct stages:</p>
<ol><li><p><strong>Initialization (Quantile Pre-binning):</strong> The feature space is
  divided into <code>max_n_prebins</code> segments containing approximately equal
  numbers of observations. This ensures the algorithm starts with a statistically
  balanced view of the data.</p></li>
<li><p><strong>Stabilization (Rare Bin Merging):</strong> Adjacent bins with frequencies
  below <code>bin_cutoff</code> are merged. The merge direction is chosen to minimize
  the distortion of the event rate (similar to ChiMerge).</p></li>
<li><p><strong>Monotonicity Enforcement:</strong> The algorithm heuristically determines
  the dominant trend (increasing or decreasing) of the Weight of Evidence (WoE)
  and iteratively merges adjacent bins that violate this trend. This step effectively
  reduces the conditional entropy of the binning sequence with respect to the target.</p></li>
<li><p><strong>IV Optimization:</strong> If the number of bins exceeds <code>max_bins</code>,
  the algorithm merges the pair of adjacent bins that results in the smallest
  decrease in total Information Value. This greedy approach ensures that the
  final discretization retains the maximum possible predictive power given the
  constraints.</p></li>
</ol><p>This joint approach (Entropy/IV + Stability constraints) makes JEDI particularly
effective for datasets with noise or non-monotonic initial distributions that
require smoothing.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ob_numerical_cm.html">ob_numerical_cm</a></code>, <code><a href="ob_numerical_ir.html">ob_numerical_ir</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example: Binning a variable with a complex relationship</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">feature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Target probability has a quadratic component (non-monotonic)</span></span></span>
<span class="r-in"><span><span class="co"># JEDI will try to force a monotonic approximation that maximizes IV</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">feature</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">feature</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">ob_numerical_jedi</span><span class="op">(</span><span class="va">feature</span>, <span class="va">target</span>,</span></span>
<span class="r-in"><span>  min_bins <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  max_bins <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  max_n_prebins <span class="op">=</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">bin</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "(-Inf;-1.052513]"      "(-1.052513;-0.097412]" "(-0.097412;0.840540]" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "(0.840540;1.253815]"   "(1.253815;1.675697]"   "(1.675697;+Inf]"      </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by José Evandeilton Lopes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

