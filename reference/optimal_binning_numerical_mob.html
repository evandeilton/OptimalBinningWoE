<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal Binning for Numerical Features using Monotonic Optimal Binning (MOB) — optimal_binning_numerical_mob • OptimalBinningWoE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Binning for Numerical Features using Monotonic Optimal Binning (MOB) — optimal_binning_numerical_mob"><meta name="description" content="Implements the Monotonic Optimal Binning (MOB) algorithm for discretizing numerical features
while maintaining monotonicity in the Weight of Evidence (WoE) values. This is particularly
useful for credit scoring and risk modeling applications where monotonicity is often a
desirable property for interpretability and regulatory compliance."><meta property="og:description" content="Implements the Monotonic Optimal Binning (MOB) algorithm for discretizing numerical features
while maintaining monotonicity in the Weight of Evidence (WoE) values. This is particularly
useful for credit scoring and risk modeling applications where monotonicity is often a
desirable property for interpretability and regulatory compliance."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OptimalBinningWoE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Optimal Binning for Numerical Features using Monotonic Optimal Binning (MOB)</h1>

      <div class="d-none name"><code>optimal_binning_numerical_mob.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the Monotonic Optimal Binning (MOB) algorithm for discretizing numerical features
while maintaining monotonicity in the Weight of Evidence (WoE) values. This is particularly
useful for credit scoring and risk modeling applications where monotonicity is often a
desirable property for interpretability and regulatory compliance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">optimal_binning_numerical_mob</span><span class="op">(</span></span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  min_bins <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  max_bins <span class="op">=</span> <span class="fl">5L</span>,</span>
<span>  bin_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  max_n_prebins <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  convergence_threshold <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  laplace_smoothing <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>An integer vector of binary target values (0 or 1)</p></dd>


<dt id="arg-feature">feature<a class="anchor" aria-label="anchor" href="#arg-feature"></a></dt>
<dd><p>A numeric vector of feature values to be binned</p></dd>


<dt id="arg-min-bins">min_bins<a class="anchor" aria-label="anchor" href="#arg-min-bins"></a></dt>
<dd><p>Minimum number of bins to create (default: 3)</p></dd>


<dt id="arg-max-bins">max_bins<a class="anchor" aria-label="anchor" href="#arg-max-bins"></a></dt>
<dd><p>Maximum number of bins to create (default: 5)</p></dd>


<dt id="arg-bin-cutoff">bin_cutoff<a class="anchor" aria-label="anchor" href="#arg-bin-cutoff"></a></dt>
<dd><p>Minimum frequency of observations in a bin (default: 0.05)</p></dd>


<dt id="arg-max-n-prebins">max_n_prebins<a class="anchor" aria-label="anchor" href="#arg-max-n-prebins"></a></dt>
<dd><p>Maximum number of prebins to create initially (default: 20)</p></dd>


<dt id="arg-convergence-threshold">convergence_threshold<a class="anchor" aria-label="anchor" href="#arg-convergence-threshold"></a></dt>
<dd><p>Threshold for convergence in the iterative process (default: 1e-6)</p></dd>


<dt id="arg-max-iterations">max_iterations<a class="anchor" aria-label="anchor" href="#arg-max-iterations"></a></dt>
<dd><p>Maximum number of iterations for the binning process (default: 1000)</p></dd>


<dt id="arg-laplace-smoothing">laplace_smoothing<a class="anchor" aria-label="anchor" href="#arg-laplace-smoothing"></a></dt>
<dd><p>Smoothing parameter for WoE calculation (default: 0.5)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following elements:</p>
<dl><dt>id</dt>
<dd><p>Bin identifiers (1-based)</p></dd>

<dt>bin</dt>
<dd><p>A character vector of bin labels showing the intervals</p></dd>

<dt>woe</dt>
<dd><p>A numeric vector of Weight of Evidence values for each bin</p></dd>

<dt>iv</dt>
<dd><p>A numeric vector of Information Value for each bin</p></dd>

<dt>count</dt>
<dd><p>An integer vector of total count of observations in each bin</p></dd>

<dt>count_pos</dt>
<dd><p>An integer vector of count of positive class observations in each bin</p></dd>

<dt>count_neg</dt>
<dd><p>An integer vector of count of negative class observations in each bin</p></dd>

<dt>event_rate</dt>
<dd><p>A numeric vector with the proportion of positive cases in each bin</p></dd>

<dt>cutpoints</dt>
<dd><p>A numeric vector of cutpoints used to create the bins</p></dd>

<dt>total_iv</dt>
<dd><p>The total Information Value of all bins combined</p></dd>

<dt>converged</dt>
<dd><p>A logical value indicating whether the algorithm converged</p></dd>

<dt>iterations</dt>
<dd><p>An integer value indicating the number of iterations run</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="mathematical-framework-">Mathematical Framework:<a class="anchor" aria-label="anchor" href="#mathematical-framework-"></a></h3>


<p><strong>Weight of Evidence (WoE)</strong>: For a bin \(i\) with Laplace smoothing <code>alpha</code>:
$$WoE_i = \ln\left(\frac{n_{1i} + \alpha}{n_{1} + m\alpha} \cdot \frac{n_{0} + m\alpha}{n_{0i} + \alpha}\right)$$
Where:</p><ul><li><p>\(n_{1i}\) is the count of positive cases in bin \(i\)</p></li>
<li><p>\(n_{0i}\) is the count of negative cases in bin \(i\)</p></li>
<li><p>\(n_{1}\) is the total count of positive cases</p></li>
<li><p>\(n_{0}\) is the total count of negative cases</p></li>
<li><p>\(m\) is the number of bins</p></li>
<li><p>\(\alpha\) is the Laplace smoothing parameter</p></li>
</ul><p><strong>Information Value (IV)</strong>: Summarizes predictive power across all bins:
$$IV = \sum_{i} (P(X|Y=1) - P(X|Y=0)) \times WoE_i$$</p>
<p><strong>Monotonicity</strong>: The algorithm ensures that WoE values either consistently increase or
decrease as the feature value increases, which aligns with business expectations that
risk should change monotonically with certain features.</p>
</div>

<div class="section">
<h3 id="algorithm-steps-">Algorithm Steps:<a class="anchor" aria-label="anchor" href="#algorithm-steps-"></a></h3>

<ol><li><p><strong>Create Initial Pre-bins</strong>: Divide the feature into equal-frequency bins</p></li>
<li><p><strong>Merge Rare Bins</strong>: Combine bins with frequency below the threshold</p></li>
<li><p><strong>Enforce Monotonicity</strong>: Identify and merge bins that violate monotonicity</p></li>
<li><p><strong>Optimize Bin Count</strong>: Adjust number of bins to stay within min/max constraints</p></li>
<li><p><strong>Calculate Metrics</strong>: Compute final WoE and IV values with Laplace smoothing</p></li>
</ol></div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Belotti, T. &amp; Crook, J. (2009). "Credit Scoring with Macroeconomic Variables
Using Survival Analysis." Journal of the Operational Research Society, 60(12), 1699-1707.</p></li>
<li><p>Hand, D.J. &amp; Adams, N.M. (2000). "Defining attributes for scorecard construction
in credit scoring." Journal of Applied Statistics, 27(5), 527-540.</p></li>
<li><p>Thomas, L.C. (2009). "Consumer Credit Models: Pricing, Profit, and Portfolios."
Oxford University Press.</p></li>
<li><p>Good, I.J. (1952). "Rational Decisions." Journal of the Royal Statistical Society,
Series B, 14, 107-114. (Origin of Laplace smoothing/additive smoothing)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic usage</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">feature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">feature</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">optimal_binning_numerical_mob</span><span class="op">(</span><span class="va">target</span>, <span class="va">feature</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Advanced usage with custom parameters</span></span></span>
<span class="r-in"><span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu">optimal_binning_numerical_mob</span><span class="op">(</span></span></span>
<span class="r-in"><span>  target <span class="op">=</span> <span class="va">target</span>,</span></span>
<span class="r-in"><span>  feature <span class="op">=</span> <span class="va">feature</span>,</span></span>
<span class="r-in"><span>  min_bins <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  max_bins <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  bin_cutoff <span class="op">=</span> <span class="fl">0.03</span>,</span></span>
<span class="r-in"><span>  laplace_smoothing <span class="op">=</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot Weight of Evidence by bin</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result2</span><span class="op">$</span><span class="va">woe</span>, type <span class="op">=</span> <span class="st">"b"</span>, xlab <span class="op">=</span> <span class="st">"Bin"</span>, ylab <span class="op">=</span> <span class="st">"WoE"</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">"Weight of Evidence by Bin"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lopes J. E.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

