<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal Binning for Numerical Variables using Local Density Binning (LDB) — optimal_binning_numerical_ldb • OptimalBinningWoE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Binning for Numerical Variables using Local Density Binning (LDB) — optimal_binning_numerical_ldb"><meta name="description" content="Implements the Local Density Binning (LDB) algorithm for optimal binning of numerical variables.
The method adjusts binning to maximize predictive power while maintaining monotonicity in Weight of Evidence (WoE),
handling rare bins, and ensuring numerical stability."><meta property="og:description" content="Implements the Local Density Binning (LDB) algorithm for optimal binning of numerical variables.
The method adjusts binning to maximize predictive power while maintaining monotonicity in Weight of Evidence (WoE),
handling rare bins, and ensuring numerical stability."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OptimalBinningWoE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Optimal Binning for Numerical Variables using Local Density Binning (LDB)</h1>

      <div class="d-none name"><code>optimal_binning_numerical_ldb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the Local Density Binning (LDB) algorithm for optimal binning of numerical variables.
The method adjusts binning to maximize predictive power while maintaining monotonicity in Weight of Evidence (WoE),
handling rare bins, and ensuring numerical stability.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">optimal_binning_numerical_ldb</span><span class="op">(</span></span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  min_bins <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  max_bins <span class="op">=</span> <span class="fl">5L</span>,</span>
<span>  bin_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  max_n_prebins <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  convergence_threshold <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>An integer binary vector (0 or 1) representing the response variable.</p></dd>


<dt id="arg-feature">feature<a class="anchor" aria-label="anchor" href="#arg-feature"></a></dt>
<dd><p>A numeric vector representing the feature to be binned.</p></dd>


<dt id="arg-min-bins">min_bins<a class="anchor" aria-label="anchor" href="#arg-min-bins"></a></dt>
<dd><p>Minimum number of bins to be created (default: 3).</p></dd>


<dt id="arg-max-bins">max_bins<a class="anchor" aria-label="anchor" href="#arg-max-bins"></a></dt>
<dd><p>Maximum number of bins allowed (default: 5).</p></dd>


<dt id="arg-bin-cutoff">bin_cutoff<a class="anchor" aria-label="anchor" href="#arg-bin-cutoff"></a></dt>
<dd><p>Minimum frequency proportion for retaining a bin (default: 0.05).</p></dd>


<dt id="arg-max-n-prebins">max_n_prebins<a class="anchor" aria-label="anchor" href="#arg-max-n-prebins"></a></dt>
<dd><p>Maximum number of pre-bins before optimization (default: 20).</p></dd>


<dt id="arg-convergence-threshold">convergence_threshold<a class="anchor" aria-label="anchor" href="#arg-convergence-threshold"></a></dt>
<dd><p>Convergence threshold for IV optimization (default: 1e-6).</p></dd>


<dt id="arg-max-iterations">max_iterations<a class="anchor" aria-label="anchor" href="#arg-max-iterations"></a></dt>
<dd><p>Maximum number of iterations allowed for optimization (default: 1000).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following elements:</p><ul><li><p><code>bins</code>: A vector of bin intervals in the format "[lower;upper)".</p></li>
<li><p><code>woe</code>: A numeric vector of WoE values for each bin.</p></li>
<li><p><code>iv</code>: A numeric vector of IV contributions for each bin.</p></li>
<li><p><code>count</code>: An integer vector of the total number of observations per bin.</p></li>
<li><p><code>count_pos</code>: An integer vector of the number of positive cases per bin.</p></li>
<li><p><code>count_neg</code>: An integer vector of the number of negative cases per bin.</p></li>
<li><p><code>cutpoints</code>: A numeric vector of the cutpoints defining the bin edges.</p></li>
<li><p><code>converged</code>: A boolean indicating whether the algorithm converged.</p></li>
<li><p><code>iterations</code>: An integer indicating the number of iterations executed.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="key-features-">Key Features:<a class="anchor" aria-label="anchor" href="#key-features-"></a></h3>

<ul><li><p><strong>Weight of Evidence (WoE)</strong>: Ensures interpretability by calculating the WoE for each bin, useful for logistic regression and risk models.</p></li>
<li><p><strong>Information Value (IV)</strong>: Evaluates the predictive power of the binned feature.</p></li>
<li><p><strong>Monotonicity</strong>: Ensures WoE values are either strictly increasing or decreasing across bins.</p></li>
<li><p><strong>Rare Bin Handling</strong>: Merges bins with low frequencies to maintain statistical reliability.</p></li>
<li><p><strong>Numerical Stability</strong>: Prevents log(0) issues through smoothing (Laplace adjustment).</p></li>
<li><p><strong>Dynamic Adjustments</strong>: Supports constraints on minimum and maximum bins, convergence thresholds, and iteration limits.</p></li>
</ul></div>

<div class="section">
<h3 id="mathematical-framework-">Mathematical Framework:<a class="anchor" aria-label="anchor" href="#mathematical-framework-"></a></h3>

<ul><li><p><strong>Weight of Evidence (WoE)</strong>: For a bin \( i \):
$$WoE_i = \ln\left(\frac{\text{Distribution of positives}_i}{\text{Distribution of negatives}_i}\right)$$</p></li>
<li><p><strong>Information Value (IV)</strong>: Aggregates predictive power across all bins:
$$IV = \sum_{i=1}^{N} (\text{Distribution of positives}_i - \text{Distribution of negatives}_i) \times WoE_i$$</p></li>
</ul></div>

<div class="section">
<h3 id="algorithm-steps-">Algorithm Steps:<a class="anchor" aria-label="anchor" href="#algorithm-steps-"></a></h3>

<ol><li><p><strong>Input Validation</strong>: Ensures the feature and target vectors are valid and properly formatted.</p></li>
<li><p><strong>Pre-Binning</strong>: Divides the feature into pre-bins based on quantile cuts or unique values.</p></li>
<li><p><strong>Rare Bin Merging</strong>: Combines bins with frequencies below <code>bin_cutoff</code> to maintain statistical stability.</p></li>
<li><p><strong>WoE and IV Calculation</strong>: Computes the WoE and IV values for each bin based on the target distribution.</p></li>
<li><p><strong>Monotonicity Enforcement</strong>: Adjusts bins to ensure WoE values are monotonic (either increasing or decreasing).</p></li>
<li><p><strong>Bin Optimization</strong>: Iteratively merges bins to respect constraints on <code>min_bins</code> and <code>max_bins</code>.</p></li>
<li><p><strong>Result Validation</strong>: Ensures bins cover the entire range of the feature without overlap and adhere to constraints.</p></li>
</ol></div>

<div class="section">
<h3 id="parameters-">Parameters:<a class="anchor" aria-label="anchor" href="#parameters-"></a></h3>

<ul><li><p><code>min_bins</code>: Minimum number of bins to be created (default: 3).</p></li>
<li><p><code>max_bins</code>: Maximum number of bins allowed (default: 5).</p></li>
<li><p><code>bin_cutoff</code>: Minimum proportion of total observations required for a bin to be retained as standalone (default: 0.05).</p></li>
<li><p><code>max_n_prebins</code>: Maximum number of pre-bins before optimization (default: 20).</p></li>
<li><p><code>convergence_threshold</code>: Threshold for determining convergence in terms of IV changes (default: 1e-6).</p></li>
<li><p><code>max_iterations</code>: Maximum number of iterations allowed for optimization (default: 1000).</p></li>
</ul></div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">feature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">optimal_binning_numerical_ldb</span><span class="op">(</span><span class="va">target</span>, <span class="va">feature</span>, min_bins <span class="op">=</span> <span class="fl">3</span>, max_bins <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">bins</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">woe</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">iv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lopes J. E.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

