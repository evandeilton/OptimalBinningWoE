<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal Binning for Numerical Variables using Local Density Binning (LDB) — optimal_binning_numerical_ldb • OptimalBinningWoE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Binning for Numerical Variables using Local Density Binning (LDB) — optimal_binning_numerical_ldb"><meta name="description" content="Implements the Local Density Binning (LDB) algorithm for optimal binning of numerical variables.
This method adapts bin boundaries based on the local density structure of the data while
maximizing the predictive relationship with a binary target variable. LDB is particularly
effective for features with non-uniform distributions or multiple modes."><meta property="og:description" content="Implements the Local Density Binning (LDB) algorithm for optimal binning of numerical variables.
This method adapts bin boundaries based on the local density structure of the data while
maximizing the predictive relationship with a binary target variable. LDB is particularly
effective for features with non-uniform distributions or multiple modes."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OptimalBinningWoE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Optimal Binning for Numerical Variables using Local Density Binning (LDB)</h1>

      <div class="d-none name"><code>optimal_binning_numerical_ldb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the Local Density Binning (LDB) algorithm for optimal binning of numerical variables.
This method adapts bin boundaries based on the local density structure of the data while
maximizing the predictive relationship with a binary target variable. LDB is particularly
effective for features with non-uniform distributions or multiple modes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">optimal_binning_numerical_ldb</span><span class="op">(</span></span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  min_bins <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  max_bins <span class="op">=</span> <span class="fl">5L</span>,</span>
<span>  bin_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  max_n_prebins <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  enforce_monotonic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  convergence_threshold <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>A binary integer vector (0 or 1) representing the target variable.</p></dd>


<dt id="arg-feature">feature<a class="anchor" aria-label="anchor" href="#arg-feature"></a></dt>
<dd><p>A numeric vector representing the feature to be binned.</p></dd>


<dt id="arg-min-bins">min_bins<a class="anchor" aria-label="anchor" href="#arg-min-bins"></a></dt>
<dd><p>Minimum number of bins (default: 3).</p></dd>


<dt id="arg-max-bins">max_bins<a class="anchor" aria-label="anchor" href="#arg-max-bins"></a></dt>
<dd><p>Maximum number of bins (default: 5).</p></dd>


<dt id="arg-bin-cutoff">bin_cutoff<a class="anchor" aria-label="anchor" href="#arg-bin-cutoff"></a></dt>
<dd><p>Minimum frequency fraction for each bin (default: 0.05).</p></dd>


<dt id="arg-max-n-prebins">max_n_prebins<a class="anchor" aria-label="anchor" href="#arg-max-n-prebins"></a></dt>
<dd><p>Maximum number of pre-bins before optimization (default: 20).</p></dd>


<dt id="arg-enforce-monotonic">enforce_monotonic<a class="anchor" aria-label="anchor" href="#arg-enforce-monotonic"></a></dt>
<dd><p>Whether to enforce monotonic WoE across bins (default: TRUE).</p></dd>


<dt id="arg-convergence-threshold">convergence_threshold<a class="anchor" aria-label="anchor" href="#arg-convergence-threshold"></a></dt>
<dd><p>Convergence threshold for optimization (default: 1e-6).</p></dd>


<dt id="arg-max-iterations">max_iterations<a class="anchor" aria-label="anchor" href="#arg-max-iterations"></a></dt>
<dd><p>Maximum iterations allowed (default: 1000).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p>
<dl><dt>id</dt>
<dd><p>Numeric identifiers for each bin (1-based).</p></dd>

<dt>bin</dt>
<dd><p>Character vector with bin intervals.</p></dd>

<dt>woe</dt>
<dd><p>Numeric vector with Weight of Evidence values for each bin.</p></dd>

<dt>iv</dt>
<dd><p>Numeric vector with Information Value contribution for each bin.</p></dd>

<dt>count</dt>
<dd><p>Integer vector with the total number of observations in each bin.</p></dd>

<dt>count_pos</dt>
<dd><p>Integer vector with the positive class count in each bin.</p></dd>

<dt>count_neg</dt>
<dd><p>Integer vector with the negative class count in each bin.</p></dd>

<dt>event_rate</dt>
<dd><p>Numeric vector with the event rate (proportion of positives) in each bin.</p></dd>

<dt>cutpoints</dt>
<dd><p>Numeric vector with the bin boundaries (excluding infinities).</p></dd>

<dt>converged</dt>
<dd><p>Logical indicating whether the algorithm converged.</p></dd>

<dt>iterations</dt>
<dd><p>Integer count of iterations performed.</p></dd>

<dt>total_iv</dt>
<dd><p>Numeric total Information Value of the binning solution.</p></dd>

<dt>monotonicity</dt>
<dd><p>Character indicating the monotonicity direction ("increasing", "decreasing", or "none").</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="algorithm-overview">Algorithm Overview<a class="anchor" aria-label="anchor" href="#algorithm-overview"></a></h3>


<p>The Local Density Binning algorithm operates in several phases:</p><ol><li><p><strong>Density Analysis</strong>: Analyzes the local density structure of the feature to identify
regions of high and low density, placing bin boundaries preferentially at density minima.</p></li>
<li><p><strong>Initial Binning</strong>: Creates initial bins based on density minima and/or quantiles.</p></li>
<li><p><strong>Statistical Optimization</strong>:</p><ul><li><p>Merges bins with frequencies below threshold for stability</p></li>
<li><p>Enforces monotonicity in Weight of Evidence (optional)</p></li>
<li><p>Adjusts to meet constraints on minimum and maximum bin count</p></li>
</ul></li>
<li><p><strong>Information Value Calculation</strong>: Computes predictive metrics for each bin</p></li>
</ol></div>

<div class="section">
<h3 id="mathematical-foundation">Mathematical Foundation<a class="anchor" aria-label="anchor" href="#mathematical-foundation"></a></h3>


<p>The algorithm employs several statistical concepts:</p><div class="section">
<h4 id="-kernel-density-estimation">1. Kernel Density Estimation<a class="anchor" aria-label="anchor" href="#-kernel-density-estimation"></a></h4>


<p>To identify the local density structure:</p>
<p>$$f_h(x) = \frac{1}{nh}\sum_{i=1}^{n}K\left(\frac{x-x_i}{h}\right)$$</p>
<p>Where:</p><ul><li><p>\(K\) is a kernel function (Gaussian kernel in this implementation)</p></li>
<li><p>\(h\) is the bandwidth parameter (selected using Silverman's rule of thumb)</p></li>
<li><p>\(n\) is the number of observations</p></li>
</ul></div>

<div class="section">
<h4 id="-weight-of-evidence-woe-">2. Weight of Evidence (WoE)<a class="anchor" aria-label="anchor" href="#-weight-of-evidence-woe-"></a></h4>


<p>For assessing the predictive power of each bin:</p>
<p>$$WoE_i = \ln\left(\frac{(p_i + \alpha) / (P + k\alpha)}{(n_i + \alpha) / (N + k\alpha)}\right)$$</p>
<p>Where:</p><ul><li><p>\(p_i\): Number of positive cases in bin \(i\)</p></li>
<li><p>\(P\): Total number of positive cases</p></li>
<li><p>\(n_i\): Number of negative cases in bin \(i\)</p></li>
<li><p>\(N\): Total number of negative cases</p></li>
<li><p>\(\alpha\): Smoothing factor (0.5 in this implementation)</p></li>
<li><p>\(k\): Number of bins</p></li>
</ul></div>

<div class="section">
<h4 id="-information-value-iv-">3. Information Value (IV)<a class="anchor" aria-label="anchor" href="#-information-value-iv-"></a></h4>


<p>For quantifying overall predictive power:</p>
<p>$$IV_i = \left(\frac{p_i}{P} - \frac{n_i}{N}\right) \times WoE_i$$</p>
<p>$$IV_{total} = \sum_{i=1}^{k} IV_i$$</p>
</div>


</div>

<div class="section">
<h3 id="advantages-of-local-density-binning">Advantages of Local Density Binning<a class="anchor" aria-label="anchor" href="#advantages-of-local-density-binning"></a></h3>

<ul><li><p><strong>Respects Data Structure</strong>: Places bin boundaries at natural gaps in the distribution</p></li>
<li><p><strong>Adapts to Multimodality</strong>: Handles features with multiple modes effectively</p></li>
<li><p><strong>Maximizes Information</strong>: Optimizes binning for predictive power</p></li>
<li><p><strong>Statistical Stability</strong>: Ensures sufficient observations in each bin</p></li>
<li><p><strong>Interpretability</strong>: Produces monotonic WoE patterns when requested</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bin, Y., Liang, S., Chen, Z., Yang, S., &amp; Zhang, L. (2019). Density-based supervised discretization
for continuous feature. <em>Knowledge-Based Systems</em>, 166, 1-17.</p>
<p>Belkin, M., &amp; Niyogi, P. (2003). Laplacian eigenmaps for dimensionality reduction and data
representation. <em>Neural Computation</em>, 15(6), 1373-1396.</p>
<p>Silverman, B. W. (1986). <em>Density Estimation for Statistics and Data Analysis</em>. Chapman and Hall/CRC.</p>
<p>Dougherty, J., Kohavi, R., &amp; Sahami, M. (1995). Supervised and unsupervised discretization of
continuous features. <em>Proceedings of the Twelfth International Conference on Machine Learning</em>, 194-202.</p>
<p>Siddiqi, N. (2006). <em>Credit Risk Scorecards: Developing and Implementing Intelligent Credit Scoring</em>.
John Wiley &amp; Sons.</p>
<p>Thomas, L. C. (2009). <em>Consumer Credit Models: Pricing, Profit and Portfolios</em>. Oxford University Press.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Generate synthetic data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">feature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic usage</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">optimal_binning_numerical_ldb</span><span class="op">(</span><span class="va">target</span>, <span class="va">feature</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Custom parameters</span></span></span>
<span class="r-in"><span><span class="va">result_custom</span> <span class="op">&lt;-</span> <span class="fu">optimal_binning_numerical_ldb</span><span class="op">(</span></span></span>
<span class="r-in"><span>  target <span class="op">=</span> <span class="va">target</span>,</span></span>
<span class="r-in"><span>  feature <span class="op">=</span> <span class="va">feature</span>,</span></span>
<span class="r-in"><span>  min_bins <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  max_bins <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>  bin_cutoff <span class="op">=</span> <span class="fl">0.03</span>,</span></span>
<span class="r-in"><span>  enforce_monotonic <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access specific components</span></span></span>
<span class="r-in"><span><span class="va">bins</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">bin</span></span></span>
<span class="r-in"><span><span class="va">woe_values</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">woe</span></span></span>
<span class="r-in"><span><span class="va">total_iv</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">total_iv</span></span></span>
<span class="r-in"><span><span class="va">monotonicity</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">monotonicity</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lopes J. E.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

