<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal Binning for Numerical Features Using Monotonic Binning via Linear Programming (MBLP) — optimal_binning_numerical_mblp • OptimalBinningWoE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal Binning for Numerical Features Using Monotonic Binning via Linear Programming (MBLP) — optimal_binning_numerical_mblp"><meta name="description" content="Implements an advanced binning algorithm for numerical features that ensures monotonicity in
the Weight of Evidence (WoE) while maximizing predictive power. The method formulates the
binning problem as an optimization task with monotonicity constraints and solves it through
an iterative process that preserves information value."><meta property="og:description" content="Implements an advanced binning algorithm for numerical features that ensures monotonicity in
the Weight of Evidence (WoE) while maximizing predictive power. The method formulates the
binning problem as an optimization task with monotonicity constraints and solves it through
an iterative process that preserves information value."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OptimalBinningWoE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Optimal Binning for Numerical Features Using Monotonic Binning via Linear Programming (MBLP)</h1>

      <div class="d-none name"><code>optimal_binning_numerical_mblp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements an advanced binning algorithm for numerical features that ensures monotonicity in
the Weight of Evidence (WoE) while maximizing predictive power. The method formulates the
binning problem as an optimization task with monotonicity constraints and solves it through
an iterative process that preserves information value.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">optimal_binning_numerical_mblp</span><span class="op">(</span></span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  min_bins <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  max_bins <span class="op">=</span> <span class="fl">5L</span>,</span>
<span>  bin_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  max_n_prebins <span class="op">=</span> <span class="fl">20L</span>,</span>
<span>  force_monotonic_direction <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  convergence_threshold <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>An integer binary vector (0 or 1) representing the target variable.</p></dd>


<dt id="arg-feature">feature<a class="anchor" aria-label="anchor" href="#arg-feature"></a></dt>
<dd><p>A numeric vector representing the feature to bin.</p></dd>


<dt id="arg-min-bins">min_bins<a class="anchor" aria-label="anchor" href="#arg-min-bins"></a></dt>
<dd><p>Minimum number of bins (default: 3).</p></dd>


<dt id="arg-max-bins">max_bins<a class="anchor" aria-label="anchor" href="#arg-max-bins"></a></dt>
<dd><p>Maximum number of bins (default: 5).</p></dd>


<dt id="arg-bin-cutoff">bin_cutoff<a class="anchor" aria-label="anchor" href="#arg-bin-cutoff"></a></dt>
<dd><p>Minimum frequency fraction for each bin (default: 0.05).</p></dd>


<dt id="arg-max-n-prebins">max_n_prebins<a class="anchor" aria-label="anchor" href="#arg-max-n-prebins"></a></dt>
<dd><p>Maximum number of pre-bins before optimization (default: 20).</p></dd>


<dt id="arg-force-monotonic-direction">force_monotonic_direction<a class="anchor" aria-label="anchor" href="#arg-force-monotonic-direction"></a></dt>
<dd><p>Force specific monotonicity direction: 0=auto, 1=increasing, -1=decreasing (default: 0).</p></dd>


<dt id="arg-convergence-threshold">convergence_threshold<a class="anchor" aria-label="anchor" href="#arg-convergence-threshold"></a></dt>
<dd><p>Convergence threshold for optimization (default: 1e-6).</p></dd>


<dt id="arg-max-iterations">max_iterations<a class="anchor" aria-label="anchor" href="#arg-max-iterations"></a></dt>
<dd><p>Maximum iterations allowed (default: 1000).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p>
<dl><dt>id</dt>
<dd><p>Numeric identifiers for each bin (1-based).</p></dd>

<dt>bin</dt>
<dd><p>Character vector with bin intervals.</p></dd>

<dt>woe</dt>
<dd><p>Numeric vector with Weight of Evidence values for each bin.</p></dd>

<dt>iv</dt>
<dd><p>Numeric vector with Information Value contribution for each bin.</p></dd>

<dt>count</dt>
<dd><p>Integer vector with the total number of observations in each bin.</p></dd>

<dt>count_pos</dt>
<dd><p>Integer vector with the positive class count in each bin.</p></dd>

<dt>count_neg</dt>
<dd><p>Integer vector with the negative class count in each bin.</p></dd>

<dt>event_rate</dt>
<dd><p>Numeric vector with the event rate (proportion of positives) in each bin.</p></dd>

<dt>cutpoints</dt>
<dd><p>Numeric vector with the bin boundaries (excluding infinities).</p></dd>

<dt>converged</dt>
<dd><p>Logical indicating whether the algorithm converged.</p></dd>

<dt>iterations</dt>
<dd><p>Integer count of iterations performed.</p></dd>

<dt>total_iv</dt>
<dd><p>Numeric total Information Value of the binning solution.</p></dd>

<dt>monotonicity</dt>
<dd><p>Character indicating monotonicity direction ("increasing", "decreasing", or "none").</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="algorithm-overview">Algorithm Overview<a class="anchor" aria-label="anchor" href="#algorithm-overview"></a></h3>


<p>The Monotonic Binning via Linear Programming algorithm operates through several coordinated steps:</p><ol><li><p><strong>Input Validation</strong>: Ensures proper formatting and constraints for data and parameters.</p></li>
<li><p><strong>Pre-Binning</strong>: Creates initial bins based on quantiles or handles special cases for few unique values.</p></li>
<li><p><strong>Statistical Optimization</strong>:</p><ul><li><p>Merges bins with frequencies below <code>bin_cutoff</code> to ensure statistical stability</p></li>
<li><p>Enforces monotonicity in Weight of Evidence (WoE) values</p></li>
<li><p>Optimizes bin count to satisfy the min_bins/max_bins constraints</p></li>
<li><p>Iteratively improves binning to maximize Information Value (IV)</p></li>
</ul></li>
<li><p><strong>Monotonicity Analysis</strong>: Automatically detects optimal monotonicity direction or applies
a forced direction if specified.</p></li>
</ol></div>

<div class="section">
<h3 id="mathematical-foundation">Mathematical Foundation<a class="anchor" aria-label="anchor" href="#mathematical-foundation"></a></h3>

<div class="section">
<h4 id="linear-programming-connection">Linear Programming Connection<a class="anchor" aria-label="anchor" href="#linear-programming-connection"></a></h4>


<p>The binning optimization problem can be formulated as a constrained optimization problem:</p>
<p>$$\max_{b} \sum_{i=1}^{k} IV_i(b)$$</p>
<p>Subject to:
$$WoE_i \leq WoE_{i+1} \quad \text{or} \quad WoE_i \geq WoE_{i+1} \quad \forall i \in \{1, \ldots, k-1\}$$
$$min\_bins \leq k \leq max\_bins$$
$$count_i \geq bin\_cutoff \times N \quad \forall i \in \{1, \ldots, k\}$$</p>
<p>Where:</p><ul><li><p>\(b\) is the set of bin boundaries</p></li>
<li><p>\(k\) is the number of bins</p></li>
<li><p>\(IV_i(b)\) is the Information Value of bin \(i\) given boundaries \(b\)</p></li>
<li><p>\(WoE_i\) is the Weight of Evidence of bin \(i\)</p></li>
</ul></div>

<div class="section">
<h4 id="weight-of-evidence-woe-">Weight of Evidence (WoE)<a class="anchor" aria-label="anchor" href="#weight-of-evidence-woe-"></a></h4>


<p>For bin \(i\), with Laplace smoothing:</p>
<p>$$WoE_i = \ln\left(\frac{(p_i + \alpha) / (P + k\alpha)}{(n_i + \alpha) / (N + k\alpha)}\right)$$</p>
<p>Where:</p><ul><li><p>\(p_i\): Number of positive cases in bin \(i\)</p></li>
<li><p>\(P\): Total number of positive cases</p></li>
<li><p>\(n_i\): Number of negative cases in bin \(i\)</p></li>
<li><p>\(N\): Total number of negative cases</p></li>
<li><p>\(\alpha\): Smoothing factor (0.5 in this implementation)</p></li>
<li><p>\(k\): Number of bins</p></li>
</ul></div>

<div class="section">
<h4 id="information-value-iv-">Information Value (IV)<a class="anchor" aria-label="anchor" href="#information-value-iv-"></a></h4>


<p>For bin \(i\):</p>
<p>$$IV_i = \left(\frac{p_i}{P} - \frac{n_i}{N}\right) \times WoE_i$$</p>
<p>Total Information Value:</p>
<p>$$IV_{total} = \sum_{i=1}^{k} IV_i$$</p>
</div>


</div>

<div class="section">
<h3 id="advantages">Advantages<a class="anchor" aria-label="anchor" href="#advantages"></a></h3>

<ul><li><p><strong>Guaranteed Monotonicity</strong>: Ensures monotonic relationship between binned variable and target</p></li>
<li><p><strong>Optimal Information Preservation</strong>: Merges bins in a way that minimizes information loss</p></li>
<li><p><strong>Flexible Direction Control</strong>: Automatically detects optimal monotonicity direction or allows
forcing a specific direction</p></li>
<li><p><strong>Statistical Stability</strong>: Ensures sufficient observations in each bin</p></li>
<li><p><strong>Efficient Implementation</strong>: Uses binary search and optimized merge strategies</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Zeng, Y. (2018). Discretization of Continuous Features by Weighs of Evidence with Isotonic Regression.
<em>arXiv preprint arXiv:1812.05089</em>.</p>
<p>Barlow, R. E., &amp; Brunk, H. D. (1972). The isotonic regression problem and its dual.
<em>Journal of the American Statistical Association</em>, 67(337), 140-147.</p>
<p>Belkin, M., &amp; Niyogi, P. (2003). Laplacian eigenmaps for dimensionality reduction and data
representation. <em>Neural Computation</em>, 15(6), 1373-1396.</p>
<p>Bertsimas, D., &amp; Tsitsiklis, J. N. (1997). <em>Introduction to Linear Optimization</em>. Athena Scientific.</p>
<p>Siddiqi, N. (2006). <em>Credit Risk Scorecards: Developing and Implementing Intelligent Credit Scoring</em>.
John Wiley &amp; Sons.</p>
<p>Thomas, L. C., Edelman, D. B., &amp; Crook, J. N. (2002). <em>Credit Scoring and Its Applications</em>.
Society for Industrial and Applied Mathematics.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Generate synthetic data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">feature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span>, <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic usage</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">optimal_binning_numerical_mblp</span><span class="op">(</span><span class="va">target</span>, <span class="va">feature</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Custom parameters with forced increasing monotonicity</span></span></span>
<span class="r-in"><span><span class="va">result_custom</span> <span class="op">&lt;-</span> <span class="fu">optimal_binning_numerical_mblp</span><span class="op">(</span></span></span>
<span class="r-in"><span>  target <span class="op">=</span> <span class="va">target</span>,</span></span>
<span class="r-in"><span>  feature <span class="op">=</span> <span class="va">feature</span>,</span></span>
<span class="r-in"><span>  min_bins <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  max_bins <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  force_monotonic_direction <span class="op">=</span> <span class="fl">1</span>  <span class="co"># Force increasing</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access specific components</span></span></span>
<span class="r-in"><span><span class="va">bins</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">bin</span></span></span>
<span class="r-in"><span><span class="va">woe_values</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">woe</span></span></span>
<span class="r-in"><span><span class="va">total_iv</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">total_iv</span></span></span>
<span class="r-in"><span><span class="va">monotonicity</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">monotonicity</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lopes J. E.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

